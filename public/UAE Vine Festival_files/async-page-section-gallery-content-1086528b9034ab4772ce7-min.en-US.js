(window["wpJsonpExtractCss"]=window["wpJsonpExtractCss"]||[]).push([["async-page-section-gallery-content"],{"./common/temp/node_modules/@sqs/core-components/primitives/SegmentedRadio.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/primitives/SegmentedRadio/index.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/components/LinkEditor.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/components/LinkEditor/index.js");a.d(t,"default",function(){return n["b"]});a.d(t,"InlineLinkEditor",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/modals/AlertModal.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/modals/DismissableModals/AlertModal.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/modals/ReviewingChangesModal.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/modals/DismissableModals/ReviewingChangesModal.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js":function(e,t,a){"use strict";a.r(t);var n=a("./common/temp/node_modules/@sqs/core-components/build/lib/navigation/Toolbar/index.js");a.d(t,"default",function(){return n["a"]})},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Edit.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8 17L19 6l-5-5L3 12v5h5zm-3-4.172l9-9L16.172 6l-9 9H5v-2.172z' fill='%230E0E0E'/%3E%3Cpath d='M3 19h16v2H3v-2z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Search.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.192 15.606a7 7 0 111.414-1.414l3.601 3.601-1.414 1.414-3.6-3.6zM15 10a5 5 0 11-10 0 5 5 0 0110 0z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Upload.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5 14.25V11.5l6-6 6 6v2.75l-5-5V20h-2V9.25l-5 5zM19 2v2H3V2h16z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./common/temp/node_modules/@sqs/rosetta-icons/svg/Video.svg":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='22' height='22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 14.3V7.7l5.5 3.3L9 14.3z' fill='%230E0E0E'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M20 4H2v14h18V4zM4 16V6h14v10H4z' fill='%230E0E0E'/%3E%3C/svg%3E"},"./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./src/main/webapp/universal/src/shared/dispatchers/alt/index.ts"));var s=function e(){(0,r.default)(this,e);this.generateActions("loadStart","loadSuccess","loadFailure")};var l=o.default.createActions(s);t.default=l;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=o;var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/slicedToArray.js"));var p=n(a("./common/temp/node_modules/react/index.js"));var u=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Icon.js"));var m=n(a("./src/main/webapp/universal/src/shared/components/FocalPoint.jsx"));var f=a("./common/temp/node_modules/@sqs/rosetta-icons/build/lib/index.js");var v=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var h=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/imageDetailUtils.js");var g=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.less"));var b=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var l=288;var i={LEFT:-1,RIGHT:1};var r=.3;var d=1e3*r;var I="left ".concat(r,"s ease-in-out");function y(e){var t=p.default.useRef();p.default.useEffect(function(){t.current=e},[e]);return t.current}function C(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none";e.forEach(function(e,t){e.style.transition=n;e.style.left="".concat((t-a)*l,"px");"none"===n&&(e.style.transform="none")})}function S(e,t,a,n){var r=e[t];var o=e[a];if(!o||!r)return;var s=parseInt(r.style.left);r.style.transition=I;r.style.transform="translateX(".concat(n*(s*-n-l),"px)");r.style.left="".concat(s+l*n,"px");o.style.transition=I;o.style.left="".concat(l*n,"px");return setTimeout(function(){C(e,t)},d)}function E(t,e){var r=p.default.useRef(null);var o=e.findIndex(function(e){return e.id===t.id});var s=y(o);p.default.useEffect(function(){if(!r.current)return;var e=null;var t=r.current.querySelectorAll("[data-is-image=true]");var a=void 0===s?o:s;C(t,a);if(o!==s)if(void 0!==s&&o+1!==s&&o-1!==s){var n=o>s?i.LEFT:i.RIGHT;e=S(t,o,s,n)}else C(t,o,I);return function(){e&&clearTimeout(e)}},[t,e,o,s,r]);return r}function j(e){var t=e.image,a=void 0===t?{}:t,n=e.onFocalPointChange;var r=a&&(a.jobId?"":a.assetUrl);var o=(0,h.useImageLoader)(r),s=(0,c.default)(o,2),l=s[0],i=s[1];var d=p.default.useRef();var u=a.recordType===v.VIDEO;return p.default.createElement("div",{className:g.default.imageContainer},p.default.createElement("div",{"data-is-image":true,ref:d,className:g.default.image,style:{backgroundImage:"url('".concat(l.src,"')")}},i&&!u&&p.default.createElement(m.default,{key:a.id,visible:i,onChange:n,imageNodeGetter:function e(){return d.current},className:g.default.focalPoint,x:a.mediaFocalPoint.x,y:a.mediaFocalPoint.y}),u&&p.default.createElement(f.Video,{color:b.colors.white,sx:{position:"absolute",top:2,left:2}})))}function o(e){var t=e.selectedImage,a=void 0===t?{}:t,n=e.images,r=e.isFirstImage,o=e.selectPreviousImage,s=e.isLastImage,l=e.selectNextImage,i=e.onFocalPointChange;var d=E(a,n);if(!a)return null;return p.default.createElement("div",{className:g.default.viewer},p.default.createElement("button",{disabled:r,onClick:o},p.default.createElement(u.default,{name:r?"chevronLargeLeftLight":"chevronLargeLeftDark"})),p.default.createElement("div",{ref:d,className:g.default.imageList},n.map(function(e,t){return p.default.createElement(j,{key:e.assetUrl,image:e,onFocalPointChange:i})})),p.default.createElement("button",{disabled:s,onClick:l},p.default.createElement(u.default,{name:s?"chevronLargeRightLight":"chevronLargeRightDark"})))}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.less":function(e,t,a){e.exports={viewer:"Carousel-viewer-1iWSy",imageList:"Carousel-imageList-2xC1x",imageContainer:"Carousel-imageContainer-1ILFO",image:"Carousel-image-2VK8h",focalPoint:"Carousel-focalPoint-3QwEx"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less":function(e,t,a){e.exports={container:"ImageDetail-container-25HgH",emptyState:"ImageDetail-emptyState-2PIIO",multiDeleteButton:"ImageDetail-multiDeleteButton-tbu9-",imageEditorButtonContainer:"ImageDetail-imageEditorButtonContainer-1K1jK",licenseBlock:"ImageDetail-licenseBlock-naGgB",actions:"ImageDetail-actions-2VwYS",stackedImages:"ImageDetail-stackedImages-1c3QP",imageContainer:"ImageDetail-imageContainer-2tRsc",image:"ImageDetail-image-1y5xn",withoutBottomBorderA:"ImageDetail-withoutBottomBorderA-1g3Js",mobileBackButton:"ImageDetail-mobileBackButton-1sxhK",formWrapper:"ImageDetail-formWrapper-2OZKg",shorterFormWrapper:"ImageDetail-shorterFormWrapper-1u-yP"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetailSchemas.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var o=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less"));var s={type:"object",properties:{body:{type:"object",properties:{html:{type:"string"}}},clickthroughUrl:{type:"string"},newWindow:{type:"boolean"}}};var l=[{type:"textarea",$mapping:"#/body/html",properties:{label:(0,r.t)("Description"),placeholder:(0,r.t)("Add a description…"),inline:false}},{type:"context",properties:{label:(0,r.t)("Link")}},{type:"link",$mapping:{url:"#/clickthroughUrl",newWindow:"#/newWindow"},properties:{modalClassName:o.default.withoutBottomBorderA}}];var i={type:"object",properties:{body:{type:"object",properties:{html:{type:"string"}}}}};var d=[{type:"string",$mapping:"#/body/html",properties:{label:(0,r.t)("Description"),placeholder:(0,r.t)("Add a description…"),inline:false}}];var u={imageJsonSchema:s,imageUiSchema:l,videoJsonSchema:i,videoUiSchema:d};t.default=u;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/imageDetailUtils.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.useImageLoader=r;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/slicedToArray.js"));var l=n(a("./common/temp/node_modules/react/index.js"));function r(t){var e=l.default.useState(false),a=(0,s.default)(e,2),n=a[0],r=a[1];var o=l.default.useMemo(function(){r(false);var e=new Image(100,200);e.onload=function(){r(true)};e.src=t;return e},[t]);return[o,n]}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var p=n(a("./common/temp/node_modules/react/index.js"));var m=n(a("./src/main/webapp/universal/src/shared/components/Form/index.js"));var f=n(a("./src/main/webapp/frontend/packages/enums/Flag.js"));var v=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Button.js"));var h=n(a("./common/temp/node_modules/@sqs/core-components/web/components/LinkEditor.js"));var g=a("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var b=a("./common/temp/node_modules/@sqs/jsf-fields/lib/es/main.js");var I=a("./src/main/webapp/frontend/packages/universal-flags/lib/index.js");var y=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/WebsiteStore/index.js"));var C=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var S=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withLicensedImagePurchaseModal/index.js"));var E=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withImageEditor/index.js"));var j=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/Carousel.js"));var P=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetailSchemas.js"));var w=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/ImageDetail.less"));var D=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var k=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");function _(r){var o=A();return function e(){var t=(0,u.default)(r),a;if(o){var n=(0,u.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,d.default)(this,a)}}function A(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var R=function e(t){return p.default.createElement(h.default,(0,r.default)({},t,{componentProps:I.legacyV6Flags.isFeatureEnabled(f.default.NESTED_CATEGORIES)?{CONTENT_PICKER:{websiteId:y.default.getState().get("id"),versions:{collection:{product:"1.1"}}}}:{}}))};var x=function(e){(0,i.default)(r,e);var n=_(r);function r(){var o;(0,s.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];o=n.call.apply(n,[this].concat(t));(0,c.default)((0,l.default)(o),"state",{value:{},isPurchaseLicenseOpen:false,imageLoaded:false});(0,c.default)((0,l.default)(o),"imageRef",p.default.createRef());(0,c.default)((0,l.default)(o),"onChange",function(e){var t=e.value;o.props.onImageDetailChanges(t)});(0,c.default)((0,l.default)(o),"renderHeader",function(){return null});(0,c.default)((0,l.default)(o),"getItemDataById",function(t){var e=o.props,a=e.items,n=e.dirtyMap;var r=n.has(t)?n.get(t):a.find(function(e){return e.id===t});return r});return o}(0,o.default)(r,[{key:"panelRenderer",value:function e(t){return t.children}},{key:"renderLicenseSpecificComponent",value:function e(t){return p.default.createElement("div",{className:w.default.licenseBlock},p.default.createElement("div",{className:w.default.actions},p.default.createElement(v.default,{color:"primary",onClick:this.props.openPurchaseLicenseModal},(0,C.t)("License")),p.default.createElement(v.default,{color:"warning",onClick:this.props.delete},(0,C.t)("Delete"))),p.default.createElement("p",null,(0,C.t)("This is a unlicensed preview image. To license it use the license link above. Watermarks will be removed after purchase.")))}},{key:"renderImageEditorButton",value:function e(t){var a=this;if(t.recordType===D.VIDEO)return p.default.createElement("div",{className:w.default.imageEditorButtonContainer});return p.default.createElement("div",{className:w.default.imageEditorButtonContainer},p.default.createElement(v.default,{color:"primary",onClick:function e(){return a.props.openEditor(t)}},(0,C.t)("Edit Image")))}},{key:"renderSingleImage",value:function e(t){if(!t)return null;var a=this.props,n=a.items,r=a.isFirstImage,o=a.selectPreviousImage,s=a.isLastImage,l=a.selectNextImage,i=a.onFocalPointChange;var d=(0,C.t)("Back");var u=t.recordType===D.IMAGE;return p.default.createElement(p.default.Fragment,null,p.default.createElement("a",{className:w.default.mobileBackButton,onClick:this.props.mobileSwitchToPicker},d),p.default.createElement(j.default,{selectedImage:t,images:n,isFirstImage:r,selectPreviousImage:o,isLastImage:s,selectNextImage:l,onFocalPointChange:i}),t.licensedAssetPreview?this.renderLicenseSpecificComponent(t):this.renderImageEditorButton(t),p.default.createElement(m.default,{components:{string:b.string,textarea:b.textarea,link:R,context:b.context},configurations:{default:{schema:u?P.default.imageJsonSchema:P.default.videoJsonSchema,uiSchema:u?P.default.imageUiSchema:P.default.videoUiSchema,value:t}},onChange:this.onChange,renderHeader:this.renderHeader,renderComponentList:this.panelRenderer,scrollContainerClassName:t.licensedAssetPreview?w.default.shorterFormWrapper:w.default.formWrapper}))}},{key:"renderEmptyState",value:function e(){return p.default.createElement("div",{className:w.default.emptyState},p.default.createElement(g.Text.Body,{color:"gray.400",fontWeight:"500"},(0,C.t)("No Image Selected")))}},{key:"renderLoadingState",value:function e(){return p.default.createElement("div",{className:w.default.emptyState},p.default.createElement(k.ActivityIndicator,null))}},{key:"checkShouldRenderLoading",value:function e(){var t;var a=this.props,n=a.selectedIds,r=a.itemsMap,o=a.items;if(!r.some(function(e){var t=e.contentItemId;return t&&t===n[0]}))return true;if(null!==(t=o.find(function(e){var t=e.id;return t===n[0]}))&&void 0!==t&&t.jobId)return true;return false}},{key:"renderContent",value:function e(){var t=this.props.selectedIds;if(!t||!t.length)return this.renderEmptyState();if(1===t.length){var a=this.checkShouldRenderLoading();if(a)return this.renderLoadingState();var n=this.getItemDataById(t[0]);return this.renderSingleImage(n)}return this.renderMultiDeleteButton()}},{key:"renderMultiDeleteButton",value:function e(){var t=this.props,a=t.selectedIds,n=t.deleteSelectedImages;return p.default.createElement("button",{className:w.default.multiDeleteButton,onClick:function e(){return n()}},(0,C.t)("Delete ({nbImages})",{nbImages:a.length}))}},{key:"render",value:function e(){return p.default.createElement("div",{className:w.default.container},this.renderContent())}}]);return r}(p.default.Component);var O=(0,E.default)((0,S.default)(x));var M=O;t.default=M;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less":function(e,t,a){e.exports={delete:"Image-delete-fZPL2",imageContainer:"Image-imageContainer-1VCI3",thirdImageContainer:"Image-thirdImageContainer-2rGKI",innerContainer:"Image-innerContainer-1tlOF",img:"Image-img-GWhos",isSelected:"Image-isSelected-2Xrgz",hiddenButtonForAccessibility:"Image-hiddenButtonForAccessibility-uXqkc",processing:"Image-processing-4GenB",mobileEditMode:"Image-mobileEditMode-3AIrv",badge:"Image-badge-s0-j9",loading:"Image-loading-2s9_y"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/Image.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var f=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));var v=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");function h(r){var o=g();return function e(){var t=(0,c.default)(r),a;if(o){var n=(0,c.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,u.default)(this,a)}}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}window.URL=window.URL||window.webkitURL;var r=new Map;var b=function e(t){if(!t)return;if(t.url)return t.url;try{var a=r.get(t);if(!a){a=window.URL.createObjectURL(t);r.set(t,a)}return a}catch(e){console.log(e);return}};var o=function(e){(0,d.default)(o,e);var r=h(o);function o(){var e;(0,s.default)(this,o);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];e=r.call.apply(r,[this].concat(a));(0,p.default)((0,i.default)(e),"revoke",function(){if(e.props.src||e.props.file&&e.props.file.url)return;try{window.URL.revokeObjectURL(b(e.props.file))}catch(e){console.error(e)}});return e}(0,l.default)(o,[{key:"render",value:function e(){var t=this.props.src||b(this.props.file);return m.default.createElement("div",{className:f.default.img,style:{backgroundImage:'url("'.concat(t,'")')},onLoad:this.revoke},!t&&m.default.createElement("div",{className:f.default.loading},m.default.createElement(v.ActivityIndicator,null)))}}]);return o}(m.default.Component);t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var u=n(a("./common/temp/node_modules/react/index.js"));var c=n(a("./common/temp/node_modules/classnames/index.js"));var p=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));var m=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Icon.js"));var f=a("./src/main/webapp/frontend/packages/enums/JobStatuses.js");var v=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.less"));function h(r){var o=g();return function e(){var t=(0,d.default)(r),a;if(o){var n=(0,d.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,i.default)(this,a)}}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var b=function(e){(0,l.default)(a,e);var t=h(a);function a(){(0,r.default)(this,a);return t.apply(this,arguments)}(0,o.default)(a,[{key:"renderBadge",value:function e(){var t=this.props,a=t.uploadStatus,n=t.jobStatus;if(a===f.FAILURE||n===f.FAILURE)return u.default.createElement("div",{className:(0,c.default)(v.default.badge,v.default.failed)},u.default.createElement(m.default,{name:"error",height:22,width:22}));return null}},{key:"render",value:function e(){var t=this.props,a=t.children,n=t.percent,r=t.itemIndex;var o=(r+1)%3===0;return u.default.createElement("div",{className:(0,c.default)(p.default.imageContainer,p.default.processing,(0,s.default)({},p.default.thirdImageContainer,o))},u.default.createElement("div",{className:v.default.innerContainer},u.default.createElement("div",{className:v.default.content},a),u.default.createElement("div",{className:v.default.progress,style:{width:"".concat(n,"%")}})),this.renderBadge())}}]);return a}(u.default.Component);var I=b;t.default=I;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.less":function(e,t,a){e.exports={content:"JobProcessingState-content-1vREc",innerContainer:"JobProcessingState-innerContainer-27-vL",progress:"JobProcessingState-progress-1yiX8",badge:"JobProcessingState-badge-etvkv",failed:"JobProcessingState-failed-3Be4u"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var d=n(a("./common/temp/node_modules/react/index.js"));var u=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/JobProcessingState.js"));var c=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/Image.js"));function p(r){var o=m();return function e(){var t=(0,i.default)(r),a;if(o){var n=(0,i.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,l.default)(this,a)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var f=function(e){(0,s.default)(a,e);var t=p(a);function a(){(0,r.default)(this,a);return t.apply(this,arguments)}(0,o.default)(a,[{key:"render",value:function e(){var t=this.props,a=t.image,n=t.itemIndex,r=t.file;return d.default.createElement(u.default,{uploadStatus:a.uploadStatus,jobStatus:a.jobStatus,percent:a.percent,itemIndex:n},d.default.createElement(c.default,{file:r,formattedWidths:null}))}}]);return a}(d.default.Component);t.default=f;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var m=n(a("./common/temp/node_modules/react/index.js"));var f=n(a("./common/temp/node_modules/classnames/index.js"));var v=a("./common/temp/node_modules/@sqs/styles/variables/baseRosetta.js");var h=a("./common/temp/node_modules/@sqs/rosetta-icons/build/lib/index.js");var g=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var b=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var I=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/Image.less"));function y(r){var o=C();return function e(){var t=(0,c.default)(r),a;if(o){var n=(0,c.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,u.default)(this,a)}}function C(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var S="MacIntel"===window.navigator.platform?"metaKey":"ctrlKey";var r=function(e){(0,d.default)(o,e);var r=y(o);function o(){var n;(0,s.default)(this,o);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n=r.call.apply(r,[this].concat(t));(0,p.default)((0,i.default)(n),"containerRef",m.default.createRef());(0,p.default)((0,i.default)(n),"delete",function(){n.props.delete(n.props.id,n.props.isImage)});(0,p.default)((0,i.default)(n),"handleClick",function(e){var t=false;var a=false;e[S]&&(t=true);e.shiftKey&&(a=true);n.props.onSelectImage(t,a)});return n}(0,l.default)(o,[{key:"componentDidUpdate",value:function e(t){var a=t.isSelected;!a&&this.props.isSelected&&this.scrollToIfNeeded()}},{key:"scrollToIfNeeded",value:function e(){try{var t=this.containerRef.current;if(!t)return;var a=t.offsetParent.scrollTop;var n=a+t.offsetParent.clientHeight;var r=t.offsetTop;var o=r+t.clientHeight;var s=0;if(o>n)s=o-n;else{if(!(r<a))return;s=r-a}t.offsetParent.scrollBy({top:s,behavior:"smooth"})}catch(e){}}},{key:"render",value:function e(){var t;var a=this.props,n=a.src,r=void 0===n?"":n,o=a.isSelected,s=a.className,l=void 0===s?"":s,i=a.mobileEditMode,d=a.isImage,u=a.processing;return m.default.createElement("div",{ref:this.containerRef,className:(0,f.default)(I.default.imageContainer,l,(t={},(0,p.default)(t,I.default.mobileEditMode,i),(0,p.default)(t,I.default.processing,u),t))},m.default.createElement("div",{className:I.default.innerContainer},m.default.createElement("div",{className:(0,f.default)(I.default.img,(0,p.default)({},I.default.isSelected,o)),"data-selectable":true,style:{backgroundImage:'url("'.concat(r,'")')},onClick:this.handleClick,role:"img"},m.default.createElement("button",{className:I.default.hiddenButtonForAccessibility},"Select image")),m.default.createElement("button",{className:I.default.delete,onClick:this.delete},m.default.createElement(h.Trash,{height:2*v.GRID_SIZE_PX,width:2*v.GRID_SIZE_PX,color:"red"})),!d&&m.default.createElement(h.Video,{color:g.colors.white,sx:{position:"absolute",top:1,left:1}}),!r&&m.default.createElement("div",{className:I.default.loading},m.default.createElement(b.ActivityIndicator,null))))}}]);return o}(m.default.Component);t.default=r;(0,p.default)(r,"defaultProps",{withoutDeleteButton:false});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/ImagePickerPanel.less":function(e,t,a){e.exports={overlay:"ImagePickerPanel-overlay-1so5o",modalWithoutMargin:"ImagePickerPanel-modalWithoutMargin-2jtEb",dragProxy:"ImagePickerPanel-dragProxy-2CNV3",body:"ImagePickerPanel-body-2fDNG",multiDeleteButton:"ImagePickerPanel-multiDeleteButton-34DKm",imagePicker:"ImagePickerPanel-imagePicker-R9RRb",addImageDropDown:"ImagePickerPanel-addImageDropDown-bG74p",popover:"ImagePickerPanel-popover-2qXXs",iconButton:"ImagePickerPanel-iconButton-2na4V",imageList:"ImagePickerPanel-imageList-1_eQA",draggedImage:"ImagePickerPanel-draggedImage-3WJBG",errorWhenLoading:"ImagePickerPanel-errorWhenLoading-1j92k",errorWhenRefreshing:"ImagePickerPanel-errorWhenRefreshing-3e0B1",dragSelectionContainer:"ImagePickerPanel-dragSelectionContainer-7fsea",mobileToolbarButton:"ImagePickerPanel-mobileToolbarButton-1Bq28",mobileToolbarTitle:"ImagePickerPanel-mobileToolbarTitle-GaUYS"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/VideoUploadModal.less":function(e,t,a){e.exports={urlEmbed:"VideoUploadModal-urlEmbed-1jObo",urlDescription:"VideoUploadModal-urlDescription-I5afg",errorText:"VideoUploadModal-errorText-3H35L"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var b=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var I=n(a("./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js"));var y=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var C=n(a("./common/temp/node_modules/@sqs/core-components/primitives/ErrorText.js"));var S=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var E=n(a("./common/temp/node_modules/@sqs/core-components/primitives/SegmentedRadio.js"));var j=n(a("./common/temp/node_modules/@sqs/core-components/primitives/Description.js"));var P=n(a("./common/temp/node_modules/@sqs/core-components/fields/EmbedField.js"));var w=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/VideoUploadModal.less"));var D=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));var o=function e(t){var a=t.videoUploadModalOpen,n=t.videoLink,r=t.embedType,o=t.embedCodeUploadOn,s=t.addMode,l=t.videoError,i=t.setVideoUploadModalStatus,d=t.onAddVideo,u=t.setEmbedType,c=t.handleUrlEmbedChange,p=t.disableVideoAddBtn;var m=s?(0,S.t)("Add"):(0,S.t)("Replace");var f=s?(0,S.t)("Add Video"):(0,S.t)("Replace Video");var v=(0,S.t)("Cancel");var h=["vimeo","youtube","animoto","wistia"];var g=(0,S.t)("Support videos from Youtube, Vimeo, Animoto or Wistia.");return b.default.createElement(y.Modal.Transition,null,a&&b.default.createElement(y.Modal,{onRequestClose:function e(){return i(false)},closeOnOverlayClicked:false},b.default.createElement(y.Modal.Overlay,null),b.default.createElement(y.Modal.Position,{position:"center"},b.default.createElement(y.Modal.Dialog,{width:"sizes.750"},b.default.createElement(I.default,null,b.default.createElement(I.default.Left,null,b.default.createElement(I.default.Button,{label:v,onClick:function e(){return i(false)}})),b.default.createElement(I.default.Center,null,b.default.createElement(I.default.Title,null,f)),b.default.createElement(I.default.Right,null,b.default.createElement(I.default.Button,{label:m,onClick:d,isDisabled:p}))),b.default.createElement("div",null,o?b.default.createElement(E.default,{options:[{label:(0,S.t)("Video URL"),value:D.default.URL},{label:(0,S.t)("Video Embed"),value:D.default.MANUAL}],value:r,onChange:u}):null,r===D.default.URL?b.default.createElement(b.default.Fragment,null,b.default.createElement(P.default,{allowVimeoBasicAuthorEmbed:true,className:w.default.urlEmbed,onChange:c,providers:h,placeholder:"https://...",value:{url:n}}),l?b.default.createElement(C.default,{className:w.default.errorText,errors:{message:(0,S.t)("Something went wrong!")}}):null,b.default.createElement(j.default,{className:w.default.urlDescription,text:g})):null)))))};o.propTypes={videoUploadModalOpen:r.default.bool.isRequired,videoLink:r.default.string.isRequired,embedType:r.default.string.isRequired,embedCodeUploadOn:r.default.bool.isRequired,addMode:r.default.bool.isRequired,videoError:r.default.bool.isRequired,setVideoUploadModalStatus:r.default.func.isRequired,onAddVideo:r.default.func.isRequired,setEmbedType:r.default.func.isRequired,handleUrlEmbedChange:r.default.func.isRequired};var s=o;t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/slicedToArray.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var E=n(a("./common/temp/node_modules/react/index.js"));var f=n(a("./common/temp/node_modules/memoize-one/dist/memoize-one.esm.js"));var j=n(a("./common/temp/node_modules/@sqs/core-components/web/navigation/Toolbar.js"));var v=n(a("./common/temp/node_modules/@sqs/core-components/web/primitives/Button.js"));var P=n(a("./common/temp/node_modules/@sqs/core-components/web/modals/ReviewingChangesModal.js"));var w=n(a("./common/temp/node_modules/@sqs/core-components/lib/web/ConfirmModal.js"));var D=n(a("./common/temp/node_modules/@sqs/core-components/web/containers/PopOver.js"));var h=n(a("./common/temp/node_modules/lodash/debounce.js"));var k=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Upload.svg"));var _=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Search.svg"));var A=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Edit.svg"));var R=n(a("./common/temp/node_modules/@sqs/rosetta-icons/svg/Video.svg"));var x=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var g=a("./src/main/webapp/frontend/packages/enums/JobStatuses.js");var b=n(a("./src/main/webapp/universal/src/shared/components/ReorderableGroup/index.jsx"));var I=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var O=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/ImagePickerPanel.less"));var y=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/index.js"));var r=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/index.js"));var C=n(a("./common/temp/node_modules/classnames/index.js"));var S=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/Image/ProcessingImage/index.js"));var M=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/isMobile.js"));var T=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/VideoUploadModal/index.js"));var U=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));var F=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var L=a("./src/main/webapp/frontend/packages/universal-flags/lib/index.js");var G=n(a("./src/main/webapp/frontend/packages/enums/Flag.js"));function N(r){var o=q();return function e(){var t=(0,p.default)(r),a;if(o){var n=(0,p.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,c.default)(this,a)}}function q(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var B=a("./src/main/webapp/universal/src/shared/components/DragSelection.jsx");var V=L.legacyV6Flags.isFeatureEnabled(G.default.GALLERY_VIDEOS_71);var z=function(e){(0,i.default)(r,e);var n=N(r);function r(){var v;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];v=n.call.apply(n,[this].concat(t));(0,m.default)((0,l.default)(v),"state",{sourceDropDownAnchor:null,isDraggingImages:false,hasFailed:false,hasCreateAssetReferenceFailed:false,mobileEditMode:false,videoUploadModalOpen:false,embedType:U.default.URL,videoLink:"",oembed:null,embedCode:"",videoError:false,jobSet:new Set});(0,m.default)((0,l.default)(v),"addImageBtnRef",E.default.createRef());(0,m.default)((0,l.default)(v),"failures",[]);(0,m.default)((0,l.default)(v),"assetReferenceFailures",new Set);(0,m.default)((0,l.default)(v),"uploaderRef",E.default.createRef());(0,m.default)((0,l.default)(v),"container",E.default.createRef());(0,m.default)((0,l.default)(v),"openSourceDropDown",function(e){var t="BUTTON"===e.target.tagName?e.target:e.target.closest("button");v.setState({sourceDropDownAnchor:t})});(0,m.default)((0,l.default)(v),"onRequestCloseSourceDropDown",function(){v.setState({sourceDropDownAnchor:null})});(0,m.default)((0,l.default)(v),"openLicensedImagePicker",function(){v.setState({sourceDropDownAnchor:null});v.props.uploader.openLicensedImagePicker()});(0,m.default)((0,l.default)(v),"openLocalImagePicker",function(){v.setState({sourceDropDownAnchor:null});v.props.uploader.openFileInput()});(0,m.default)((0,l.default)(v),"retryUpload",function(){var e=v.failures.map(function(e){var t=e.token;var a=v.props.uploadingFilesMap.get(t);v.props.removeFromUploadList(t);return a});v.props.uploader.onFileUploaderChanges(e);v.clearFailures()});(0,m.default)((0,l.default)(v),"clearFailures",function(){v.failures.forEach(function(e){v.props.removeFromUploadList(e.token);e.uploadStatus===g.FAILURE&&v.props.cancelUpload(e.token);e.jobStatus===g.FAILURE&&v.props.cancelJob(e.data.data.job.id)});v.failures=[];v.setState({hasFailed:false})});(0,m.default)((0,l.default)(v),"getItemNodesForDragSelection",function(){if(!v.container.current)return;return Array.from(v.container.current.querySelectorAll('[data-selectable="true"]'))});(0,m.default)((0,l.default)(v),"onDragSelectionChange",function(e){var t=e.added,a=e.removed;v.props.onSelectImages([].concat((0,u.default)(t),(0,u.default)(a)),v.state.mobileEditMode,true)});(0,m.default)((0,l.default)(v),"onDragSelectionMouseDown",function(e){e.metaKey||e.ctrlKey||e.shiftKey||v.props.clearSelection()});(0,m.default)((0,l.default)(v),"renderUploading",function(t,e){var a=v.props.uploads.find(function(e){return e.token===t.uploadToken});return E.default.createElement(S.default,{image:a,file:a.file,itemIndex:e})});(0,m.default)((0,l.default)(v),"checkJob",function(a){var e=v.props,n=e.finishedJobs,t=e.onChange;a?v.setState(function(e){var t=e.jobSet;t.add(a);return{jobSet:t}}):v.state.jobSet.size>0&&v.setState(function(e){var t=e.jobSet;t.forEach(function(e){n.includes(e)&&t.delete(e)});return{jobSet:t}},(0,h.default)(function(){0===v.state.jobSet.size&&t()},250))});(0,m.default)((0,l.default)(v),"renderImage",function(n,e,t,a){var r=v.state,o=r.isDraggingImages,s=r.mobileEditMode;var l=v.props,i=l.onSelectImages,d=l.deleteItem,u=l.selectedIds,c=l.items;if(n.uploadToken)return v.renderUploading(n,a);var p=c.find(function(e){return e.id===n.contentItemId})||n;var m=p.jobId?"":p.assetUrl;v.checkJob(p.jobId);var f=u.find(function(e){return p.id===e});return E.default.createElement(y.default,{src:m,className:t.isDragging||o&&f?O.default.draggedImage:void 0,isSelected:u.find(function(e){return p.id===e}),delete:d,id:p.id,onSelectImage:function e(t,a){i([n],s,t,a)},mobileEditMode:s,isImage:p.recordType===F.IMAGE,processing:p.jobId})});(0,m.default)((0,l.default)(v),"checkFailure",function(e){v.failures=[];v.assetReferenceFailures.clear();e.forEach(function(t){var e=v.props.uploads.find(function(e){return t.uploadToken&&e.token===t.uploadToken||t.jobId&&e.jobId===t.jobId});e&&(e.uploadStatus===g.FAILURE||e.jobStatus===g.FAILURE)&&v.props.uploadingFilesMap.get(e.token)&&v.failures.push(e);t.isCreateAssetReferenceFailure&&v.assetReferenceFailures.add(t)});v.setState({hasFailed:v.failures.length>0,hasCreateAssetReferenceFailed:v.assetReferenceFailures.size>0})});(0,m.default)((0,l.default)(v),"getRenderingItems",function(t){var e=t.itemsMap.filter(function(e){if(e.uploadToken)return!!t.uploadingFilesMap.get(e.uploadToken);return true});return e});(0,m.default)((0,l.default)(v),"getReorderableGroupItems",(0,f.default)(function(e,t,a){t(e.itemsMap);return a(e)}));(0,m.default)((0,l.default)(v),"switchToMobileEditMode",function(){v.setState({mobileEditMode:true,sourceDropDownAnchor:null})});(0,m.default)((0,l.default)(v),"handleMobileButtonClicked",function(e){v.state.mobileEditMode?v.setState({mobileEditMode:false}):v.openSourceDropDown(e)});(0,m.default)((0,l.default)(v),"onReorder",function(e,t){var a=v.props,n=a.items,r=a.onChange;var o=(0,u.default)(e);o.sort(function(e,t){var a=(0,d.default)(e,2),n=a[0],r=a[1];var o=(0,d.default)(t,2),s=o[0],l=o[1];return r>l?1:-1});var s=o[0][1];var l;s>0&&(l=n[s-1].id);var i=o.map(function(e){var t=(0,d.default)(e,1),a=t[0];return a.contentItemId});I.default.reorderItems(v.props.galleryId,i,l).then(function(){r()}).catch(function(e){return console.log(e)})});(0,m.default)((0,l.default)(v),"getSelectedData",function(e,a){var t=e.map(function(t){return a.find(function(e){return e.contentItemId===t})});return t});(0,m.default)((0,l.default)(v),"renderImageList",function(){var e=v.props,a=e.selectedIds,t=e.itemsMap;var n=v.state,r=n.mobileEditMode,o=n.isDraggingImages;var s=(0,C.default)(O.default.imageList,{"edit-on":r,"edit-off":!r,dragging:o});return E.default.createElement(E.default.Fragment,null,E.default.createElement(b.default,{watchExtraChildItems:true,className:s,proxyClassName:O.default.dragProxy,childItems:v.getReorderableGroupItems(v.props,v.checkFailure,v.getRenderingItems),childItemRenderer:v.renderImage,getChildKeyFromItem:function e(t){return t.key},onDragEnd:function e(){v.setState({isDraggingImages:false})},onDragStart:function e(t){if(!a.find(function(e){return e&&e===t.contentItemId})){v.props.clearSelection();v.props.onSelectImages([t],v.state.mobileEditMode,false)}v.setState({isDraggingImages:true})},onReorder:v.onReorder,itemsToMultiReorder:v.getSelectedData(a,t)}),E.default.createElement("div",{className:O.default.dragSelectionContainer},E.default.createElement(B,{key:"dragSelection",items:v.getRenderingItems(v.props),itemNodesGetter:v.getItemNodesForDragSelection,onMouseDown:v.onDragSelectionMouseDown,onSelectionChange:v.onDragSelectionChange,onDragEnd:v.props.resetSelection})))});(0,m.default)((0,l.default)(v),"setVideoUploadModalStatus",function(e){v.setState({videoUploadModalOpen:e,videoLink:"",oembed:null,embedCode:"",videoError:false})});(0,m.default)((0,l.default)(v),"setEmbedType",function(e){v.setState({embedType:e})});(0,m.default)((0,l.default)(v),"handleUrlEmbedChange",function(e){v.setState({oembed:e,videoLink:e.url||"",videoError:false})});(0,m.default)((0,l.default)(v),"handleEmbedCodeChange",function(e){var t={html:e,resolvedBy:U.default.MANUAL};v.setState({oembed:t,embedCode:e})});(0,m.default)((0,l.default)(v),"onAddVideo",function(){if(v.state.oembed&&v.state.oembed.resolved){v.props.uploadVideo(v.state.oembed,v.state.embedType);v.setVideoUploadModalStatus(false);v.setState({videoError:false})}else v.setState({videoError:true})});(0,m.default)((0,l.default)(v),"retryCreateAssetReference",function(){v.assetReferenceFailures.forEach(function(e){e.createAssetReference();delete e.isCreateAssetReferenceFailure;delete e.createAssetReference});v.clearAssetReferenceFailures()});(0,m.default)((0,l.default)(v),"cancelCreateAssetReference",function(){I.default.cancelCreateAssetReference(Array.from(v.assetReferenceFailures));v.clearAssetReferenceFailures()});(0,m.default)((0,l.default)(v),"clearAssetReferenceFailures",function(){v.assetReferenceFailures.clear();v.setState({hasCreateAssetReferenceFailed:false})});return v}(0,s.default)(r,[{key:"renderErrorIfNeeded",value:function e(t){var a=this.props.items;if(!t)return null;var n=(0,x.t)("Something went wrong.");var r=(0,x.t)("Reload");if(!a||!a.length)return E.default.createElement("div",{className:O.default.errorWhenLoading},E.default.createElement("p",null,n),t.reload?E.default.createElement(v.default,{color:"primary",onClick:t.reload},r):null);return E.default.createElement("div",{className:O.default.errorWhenRefreshing},E.default.createElement("p",null,n),t.reload?E.default.createElement(v.default,{color:"primary",onClick:t.reload},r):null)}},{key:"render",value:function e(){var t=this;var a=this.props,n=a.error,r=a.isInitialized,o=a.onRequestClose;var s=this.state,l=s.videoUploadModalOpen,i=s.videoLink,d=s.embedType,u=s.embedCode,c=s.videoError,p=s.oembed;var m=this.getRenderingItems(this.props);var f=m.length>0;var v=(0,x.t)("Drag to Reorder");var h=(0,x.t)("Gallery Manager");var g=(0,x.t)("Gallery");var b=(0,x.t)("Done");var I=(0,x.t)("Edit");var y=(0,x.t)("Close");var C=(0,M.default)()?this.state.mobileEditMode?v:h:g;var S=this.state.mobileEditMode?b:I;return E.default.createElement("div",{className:O.default.imagePicker,onDragEnter:this.onDragEnter},E.default.createElement(j.default,null,E.default.createElement(j.default.Left,null,E.default.createElement(j.default.Button,{className:O.default.mobileToolbarButton,label:y,onClick:o})),E.default.createElement(j.default.Center,null,E.default.createElement(j.default.Title,{className:O.default.mobileToolbarTitle},C)),E.default.createElement(j.default.Right,null,!(0,M.default)()&&E.default.createElement(j.default.IconButton,{ref:this.addImageBtnRef,name:"addBlock",onClick:this.openSourceDropDown}),(0,M.default)()&&E.default.createElement(j.default.Button,{label:S,onClick:this.handleMobileButtonClicked,className:O.default.mobileToolbarButton}))),this.state.sourceDropDownAnchor&&E.default.createElement(D.default,{anchor:this.state.sourceDropDownAnchor,hideArrow:true,position:"bottom",isOpen:true,closeOnClickOutside:true,bodyClassName:O.default.popover,onRequestClose:this.onRequestCloseSourceDropDown},(0,M.default)()&&E.default.createElement("button",{className:O.default.iconButton,onClick:this.switchToMobileEditMode},E.default.createElement("img",{className:O.default.editIcon,src:A.default,alt:""}),E.default.createElement("p",{className:O.default.iconText},(0,x.t)("Manage Images"))),!(0,M.default)()&&E.default.createElement("button",{className:O.default.iconButton,onClick:this.openLicensedImagePicker},E.default.createElement("img",{className:O.default.searchIcon,src:_.default,alt:""}),E.default.createElement("p",{className:O.default.iconText},(0,x.t)("Search Images"))),E.default.createElement("button",{className:O.default.iconButton,onClick:this.openLocalImagePicker},E.default.createElement("img",{className:O.default.uploadIcon,src:k.default,alt:""}),E.default.createElement("p",{className:O.default.iconText},(0,x.t)("Upload Images"))),V&&E.default.createElement("button",{className:O.default.iconButton,onClick:function e(){return t.setVideoUploadModalStatus(true)}},E.default.createElement("img",{className:O.default.videoIcon,src:R.default,alt:""}),E.default.createElement("p",{className:O.default.iconText},(0,x.t)("Add Video")))),E.default.createElement("div",{className:O.default.body,ref:this.container},r&&this.renderImageList(),!n&&r?this.props.uploader.renderOverlayIfPossible(f):null,this.renderErrorIfNeeded(n)),E.default.createElement(P.default,{title:(0,x.t)("Something went wrong"),message:(0,x.t)("Your images failed to upload"),saveLabel:(0,x.t)("Try Again"),cancelLabel:(0,x.t)("Cancel"),discardLabel:(0,x.t)("Delete Image"),cancelStyle:"default",confirmStyle:"default",isReviewingChanges:this.state.hasFailed,onSave:this.retryUpload,onDismiss:this.clearFailures,onDiscard:this.clearFailures,onRequestClose:this.clearFailures}),E.default.createElement(w.default,{isOpen:this.state.hasCreateAssetReferenceFailed,title:(0,x.t)("Something went wrong"),message:(0,x.t)("Your images failed to create"),onConfirm:this.retryCreateAssetReference,confirmLabel:(0,x.t)("Try Again"),onDismiss:this.cancelCreateAssetReference}),E.default.createElement(T.default,{videoUploadModalOpen:l,setVideoUploadModalStatus:this.setVideoUploadModalStatus,setEmbedType:this.setEmbedType,onAddVideo:this.onAddVideo,handleEmbedCodeChange:this.handleEmbedCodeChange,handleUrlEmbedChange:this.handleUrlEmbedChange,embedCodeUploadOn:false,videoLink:i,embedType:d,embedCode:u,addMode:true,videoError:c,disableVideoAddBtn:!(null!==p&&void 0!==p&&p.url)}))}}]);return r}(E.default.Component);var J=(0,r.default)(z);var W=J;t.default=W;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var r=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var c=r(a("./common/temp/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var o=r(a("./common/temp/node_modules/@babel/runtime/regenerator/index.js"));var s=r(a("./common/temp/node_modules/@babel/runtime/helpers/asyncToGenerator.js"));var l=r(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var i=r(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var d=r(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var u=r(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var p=r(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var m=r(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var f=r(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var v=n(a("./common/temp/node_modules/react/index.js"));var h=r(a("./common/temp/node_modules/lodash/last.js"));var g=r(a("./common/temp/node_modules/lodash/compact.js"));var b=r(a("./common/temp/node_modules/lodash/debounce.js"));var I=r(a("./common/temp/node_modules/prop-types/index.js"));var y=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var C=r(a("./common/temp/node_modules/@sqs/core-components/lib/web/ConfirmModal.js"));var S=a("./src/main/webapp/frontend/packages/universal-utils/cjs/index.js");var E=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var j=r(a("./common/temp/node_modules/classnames/index.js"));var P=a("./src/main/webapp/universal/src/shared/constants/UploadMaxSize.js");var w=a("./src/main/webapp/universal/src/shared/constants/UploadMimeTypes.js");var D=a("./src/main/webapp/universal/src/apps/App/shared/redux/CmsStoreProvider.js");var k=a("./src/main/webapp/universal/src/apps/App/shared/redux/actions/sectionActions.js");var _=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/PageSectionsActions.js"));var A=r(a("./src/main/webapp/universal/src/apps/App/shared/stores/ContentItemStore.js"));var R=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var x=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js"));var O=r(a("./src/main/webapp/universal/src/shared/stores/UploadStore.js"));var M=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImagePickerPanel/index.js"));var T=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/ImageDetail/index.js"));var U=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.less"));var F=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/errors.js");var L=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/deleteMessages.js"));var G=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContextProvider.js"));var N=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/makeCancellable.js");function q(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function B(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?q(Object(a),true).forEach(function(e){(0,f.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function V(r){var o=z();return function e(){var t=(0,m.default)(r),a;if(o){var n=(0,m.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,p.default)(this,a)}}function z(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var J=230;var W=function(e){(0,u.default)(r,e);var n=V(r);function r(){var u;(0,l.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];u=n.call.apply(n,[this].concat(t));(0,f.default)((0,d.default)(u),"state",{galleryId:u.props.galleryId,uploadingFilesMap:new Map,shouldDelete:null,deletionMessages:{},dropZoneEnabled:false,isInitialized:false,storedSection:null,isBackspaceToDeleteEnabled:true,mobileSwitchToContent:false,mobileShowDetail:false,selectedIds:[],dirtyMap:new Map});(0,f.default)((0,d.default)(u),"lastSelectedId",null);(0,f.default)((0,d.default)(u),"dropzonePortalContainerRef",v.default.createRef());(0,f.default)((0,d.default)(u),"setViewportHeight",function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))});(0,f.default)((0,d.default)(u),"handleKeyUp",function(e){S.Keyboard.isBackspaceKey(e)&&u.state.isBackspaceToDeleteEnabled&&document.activeElement===document.body&&u.deleteSelectedImages()});(0,f.default)((0,d.default)(u),"setIsBackspaceToDeleteEnabled",function(e){u.setState({isBackspaceToDeleteEnabled:e})});(0,f.default)((0,d.default)(u),"loadImages",(0,N.withCanceledState)(function(e){var t=e.makeCancelablePromise,a=e.makeCancelableCallback;return function(){if(!u.props.galleryId)return;u.loadImageTimeout=setTimeout(a(function(){if(!u.props.galleryId)return;x.default.loadStart();u.setState({isInitialized:false,error:null});A.default.fetchForCollection(u.props.galleryId).then(function(){x.default.loadSuccess({collectionId:u.props.galleryId,contentItems:u.props.items,uploads:O.default.getCurrentUploadsForCollection(u.props.galleryId)});u.setState({isInitialized:true,selectedIds:u.initSelection(u.props.items)})}).catch(function(e){x.default.loadFailure({collectionId:u.props.galleryId,error:e});u.setState({error:{type:F.FAILED_TO_LOAD_IMAGES,reload:u.loadImages}})})}),10)}}));(0,f.default)((0,d.default)(u),"initSelection",function(e){if(0===u.state.selectedIds.length&&e.length){u.lastSelectedId={id:e[0].id,isSelected:true};return[e[0].id]}return[]});(0,f.default)((0,d.default)(u),"onRequestClose",(0,s.default)(o.default.mark(function e(){var a;return o.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:a=u.state.storedSection;if(a){t.next=3;break}return t.abrupt("return");case 3:u.lastSelectedId=null;t.next=6;return u.saveItemDetailsIfDirty();case 6:_.default.setIsGalleryContentEditorOpen({isGalleryContentEditorOpen:false});u.setState({sourceDropDownPosition:null,selectedIds:[],dropZoneEnabled:false,storedSection:null,dirtyMap:new Map});case 8:case"end":return t.stop()}},e)})));(0,f.default)((0,d.default)(u),"handleOnChange",function(){var e=u.props.section,t=void 0===e?{}:e;if("gallery"===(null===t||void 0===t?void 0:t.sectionDefinitionName)){var a;D.cmsStore.dispatch((0,k.sectionChanged)(B({sectionId:t.id},t,{jsonData:B({},null===t||void 0===t?void 0:t.jsonData,{galleryOptions:B({},null===t||void 0===t?void 0:null===(a=t.jsonData)||void 0===a?void 0:a.galleryOptions,{lastUpdate:Date.now()})})})))}else D.cmsStore.dispatch((0,k.sectionChanged)(B({sectionId:t.id},t,{galleryOptions:B({},null===t||void 0===t?void 0:t.galleryOptions,{lastUpdate:Date.now()})})))});(0,f.default)((0,d.default)(u),"deleteItem",function(e,t){var a=t?"image":"video";u.setState({shouldDelete:e,deletionMessages:{title:L.default.singleTitle[a],message:L.default.singleDetail[a]}})});(0,f.default)((0,d.default)(u),"deleteSelectedImages",function(){if(!u.state.selectedIds.length)return;var e=u.state.selectedIds;var t=u.getDeleteTypeText();u.setState({shouldDelete:e,deletionMessages:{title:L.default.multipleTitle[t],message:L.default.multipleDetail[t]}})});(0,f.default)((0,d.default)(u),"doDeleteImages",(0,N.withCanceledState)(function(e){var t=e.makeCancelablePromise;return function(){var e=u.state.shouldDelete;if(null===e)return;Array.isArray(e)?t(R.default.deleteMany(e)).then(function(){u.setState({selectedIds:[]});u.handleOnChange()}):t(R.default.delete(e)).then(function(){u.setState(function(e){var t=e.selectedIds;return{selectedIds:1===t.length?[]:t}});u.handleOnChange()});u.setState({shouldDelete:null})}}));(0,f.default)((0,d.default)(u),"getDeleteTypeText",function(){var t=0;var a=u.state.selectedIds;var e=u.props.items.filter(function(e){return a.includes(e.id)});e.forEach(function(e){e.recordType!==E.IMAGE&&t++});var n=t===a.length?"video":0===t?"image":"mixed";return n});(0,f.default)((0,d.default)(u),"cancelDeletion",function(){u.setState({shouldDelete:null})});(0,f.default)((0,d.default)(u),"addFileToUploadList",function(a,n){u.setState(function(e){var t=e.uploadingFilesMap;t.set(a,n);return{uploadingFilesMap:t}})});(0,f.default)((0,d.default)(u),"removeFromUploadList",function(a){u.setState(function(e){var t=e.uploadingFilesMap;t.delete(a);return{uploadingFilesMap:t}})});(0,f.default)((0,d.default)(u),"onImageDetailChanges",function(a){1===u.state.selectedIds.length&&u.setState(function(e){var t=e.dirtyMap;t.set(a.id,a);return{dirtyMap:t}})});(0,f.default)((0,d.default)(u),"handleFocalPointChange",function(e){u.state.selectedIds&&1===u.state.selectedIds.length&&u.updateField(u.state.selectedIds[0],"mediaFocalPoint",e)});(0,f.default)((0,d.default)(u),"updateField",(0,b.default)(function(e,t,a){R.default.updateField(e,t,a).then(function(){u.handleOnChange()})},250));(0,f.default)((0,d.default)(u),"clearDirtyMap",function(){u.setState({dirtyMap:new Map})});(0,f.default)((0,d.default)(u),"saveItemDetailsIfDirty",function(){if(0===u.state.dirtyMap.size)return;var e=Array.from(u.state.dirtyMap.values());u.clearDirtyMap();return R.default.updateForCollection(e[0]).then(function(){u.handleOnChange()})});(0,f.default)((0,d.default)(u),"onGalleryIdChanges",function(e){var t=u.props.section,a=void 0===t?{}:t;"gallery"===(null===a||void 0===a?void 0:a.sectionDefinitionName)?D.cmsStore.dispatch((0,k.sectionChanged)(B({sectionId:u.props.section.id},a,{jsonData:B({},u.props.section.jsonData,{galleryOptions:B({},u.props.section.jsonData.galleryOptions,{transientGalleryId:e})})}))):D.cmsStore.dispatch((0,k.sectionChanged)(B({sectionId:u.props.section.id},a,{galleryOptions:B({},u.props.section.galleryOptions,{transientGalleryId:e})})))});(0,f.default)((0,d.default)(u),"onSelectImages",function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=Array.isArray(e)?e:[e];var r=e.map(function(e){return null===e||void 0===e?void 0:e.contentItemId});var o=u.state.selectedIds?(0,c.default)(u.state.selectedIds):[];u.saveItemDetailsIfDirty();if(n&&1===e.length&&r.length&&null!==u.lastSelectedId){u.onSelectImagesRange(e[0]);return}if(a){u.lastSelectedId={id:(0,h.default)(r),isSelected:!o.includes((0,h.default)(r))};r.forEach(function(t){var e=o.includes(t);e?o=o.filter(function(e){return e!==t}):o.push(t)})}else{o=r;u.lastSelectedId={id:(0,h.default)(o),isSelected:true}}u.setState({selectedIds:(0,g.default)(o)});!t&&u.mobileShowDetail&&u.setState({mobileSwitchToContent:true})});(0,f.default)((0,d.default)(u),"onSelectImagesRange",function(e){var t=u.state.selectedIds;var a=u.props.items;var n=(0,c.default)(t);var r=e.contentItemId;var o=a.findIndex(function(e){return u.lastSelectedId.id===e.id});var s=a.findIndex(function(e){return r===e.id});if(-1===o||-1===s)return null;var l=a.slice(Math.min(o,s),Math.max(o,s)+1);var i=l.map(function(e){return e.id});if(u.lastSelectedId.isSelected&&!n.includes(r)){var d=i.filter(function(e){return!t.includes(e)});n=[].concat(n,d)}else n=n.filter(function(e){return!i.includes(e)});u.lastSelectedId.id=r;u.setState({selectedIds:(0,g.default)(n)})});(0,f.default)((0,d.default)(u),"clearSelection",function(){u.saveItemDetailsIfDirty();u.lastSelectedId=null;u.setState({selectedIds:[]})});(0,f.default)((0,d.default)(u),"resetSelection",function(){var e,t;if(u.state.selectedIds&&u.state.selectedIds.length)return;var a=[null===(e=u.props.items[0])||void 0===e?void 0:e.id];u.lastSelectedId={id:null===(t=u.props.items[0])||void 0===t?void 0:t.id,selected:true};u.setState({selectedIds:(0,g.default)(a)})});(0,f.default)((0,d.default)(u),"isFirstImageSelected",function(){var e;return 1===u.state.selectedIds.length&&u.state.selectedIds[0]===(null===(e=u.props.items[0])||void 0===e?void 0:e.id)});(0,f.default)((0,d.default)(u),"isLastImageSelected",function(){var e;return 1===u.state.selectedIds.length&&u.state.selectedIds[0]===(null===(e=u.props.items[u.props.items.length-1])||void 0===e?void 0:e.id)});(0,f.default)((0,d.default)(u),"selectPreviousImage",function(){if(!u.isFirstImageSelected()){u.saveItemDetailsIfDirty();u.setState(function(e){var t=e.selectedIds;var a=u.props.items;var n=Math.max(0,a.findIndex(function(e){return t[0]===e.id})-1);return{selectedIds:[a[n].id]}})}});(0,f.default)((0,d.default)(u),"selectNextImage",function(){if(!u.isLastImageSelected()){u.saveItemDetailsIfDirty();u.setState(function(e){var t=e.selectedIds;var a=u.props.items;var n=Math.min(a.length-1,a.findIndex(function(e){return t[0]===e.id})+1);return{selectedIds:[a[n].id]}})}});(0,f.default)((0,d.default)(u),"onDragEnter",function(){return u.setState({dropZoneEnabled:true})});(0,f.default)((0,d.default)(u),"disableDropZone",function(){return u.setState({dropZoneEnabled:false})});(0,f.default)((0,d.default)(u),"mobileSwitchToPicker",function(){u.setState({mobileSwitchToContent:false})});return u}(0,i.default)(r,[{key:"componentDidMount",value:function e(){this.loadImages();document.addEventListener("keyup",this.handleKeyUp);window.addEventListener("resize",this.setViewportHeight);this.setViewportHeight()}},{key:"componentDidUpdate",value:function e(t){t.galleryId!==this.props.galleryId&&this.loadImages()}},{key:"getSnapshotBeforeUpdate",value:function e(t){var a=this;t.isGalleryContentEditorOpen&&!this.props.isGalleryContentEditorOpen&&this.state.storedSection&&(this.cleanupFallbackTimeout=setTimeout(function(){a.onRequestClose()}));return null}},{key:"componentWillUnmount",value:function e(){if(this.cleanupFallbackTimeout){clearTimeout(this.cleanupFallbackTimeout);this.cleanupFallbackTimeout=null}if(this.loadImageTimeout){clearTimeout(this.loadImageTimeout);this.loadImageTimeout=null}this.loadImages.cancel();this.updateField.cancel();this.doDeleteImages.cancel();document.removeEventListener("keyup",this.handleKeyUp);this.lastSelectedId=null;window.removeEventListener("resize",this.setViewportHeight)}},{key:"render",value:function e(){var t=this.props,a=t.isGalleryContentEditorOpen,n=t.galleryId,r=t.items,o=t.uploads,s=t.itemsMap,l=t.finishedJobs;return v.default.createElement(y.Modal.Transition,{duration:J},a&&v.default.createElement(y.Modal,{lockScroll:false,closeOnEsc:true,closeOnOverlayClicked:true,onRequestClose:this.onRequestClose},v.default.createElement(y.Modal.Overlay,null),v.default.createElement(y.Modal.Position,{draggable:true,position:"center",constrainTo:"window"},v.default.createElement(y.Modal.Dialog,{className:U.default.dialogContainer},v.default.createElement("div",{onDragEnter:this.onDragEnter,className:U.default.innerContainer},v.default.createElement(G.default,{collectionId:n,items:r,maxFileSizeMb:P.MAX_SIZE,validMimeTypes:w.IMAGE_MIME_TYPES,onCollectionIdCreated:this.onGalleryIdChanges,onStartUploadingFile:this.addFileToUploadList,handleOnChange:this.handleOnChange,uploadingFilesMap:this.state.uploadingFilesMap,dropzonePortalContainerRef:this.dropzonePortalContainerRef,dirtyMap:this.state.dirtyMap,clearDirtyMap:this.clearDirtyMap,uploads:o},v.default.createElement("div",{className:(0,j.default)(U.default.panel,(0,f.default)({},U.default.hide,this.state.mobileSwitchToContent))},v.default.createElement(M.default,{isInitialized:this.state.isInitialized,galleryId:n,onRequestClose:this.onRequestClose,onChange:this.handleOnChange,onGalleryIdChanges:this.onGalleryIdChanges,onSelectImages:this.onSelectImages,clearSelection:this.clearSelection,resetSelection:this.resetSelection,selectedIds:this.state.selectedIds,deleteItem:this.deleteItem,items:r,uploadingFilesMap:this.state.uploadingFilesMap,removeFromUploadList:this.removeFromUploadList,dropZoneEnabled:this.state.dropZoneEnabled,disableDropZone:this.disableDropZone,error:this.state.error,mobileHidePicker:this.state.mobileSwitchToContent,uploads:o,itemsMap:s,finishedJobs:l})),v.default.createElement("div",{className:U.default.panel},v.default.createElement(T.default,{selectedIds:this.state.selectedIds,items:r,deleteSelectedImages:this.deleteSelectedImages,selectPreviousImage:this.selectPreviousImage,selectNextImage:this.selectNextImage,isFirstImage:this.isFirstImageSelected(),isLastImage:this.isLastImageSelected(),delete:this.deleteSelectedImages,onImageDetailChanges:this.onImageDetailChanges,onFocalPointChange:this.handleFocalPointChange,setIsBackspaceToDeleteEnabled:this.setIsBackspaceToDeleteEnabled,mobileSwitchToPicker:this.mobileSwitchToPicker,itemsMap:s,dirtyMap:this.state.dirtyMap})),v.default.createElement(C.default,{isOpen:null!==this.state.shouldDelete,title:this.state.deletionMessages.title,message:this.state.deletionMessages.message,onConfirm:this.doDeleteImages,onDismiss:this.cancelDeletion,onRequestClose:this.cancelDeletion,cancelStyle:"default",confirmStyle:"default"}),v.default.createElement("div",{ref:this.dropzonePortalContainerRef})))))))}}],[{key:"getDerivedStateFromProps",value:function e(t,a){var n=null;if(t.section&&(!a.storedSection||t.section.id!==a.storedSection.id)){n=n||{};n.storedSection=t.section}if(t.galleryId!==a.galleryId){n=n||{};n.galleryId=t.galleryId;n.isInitialized=!t.galleryId;n.error=null;n.storedSection=t.section}return n}}]);return r}(v.Component);t.default=W;(0,f.default)(W,"propTypes",{isGalleryContentEditorOpen:I.default.bool.isRequired,cloneable:I.default.bool});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.less":function(e,t,a){e.exports={dialogContainer:"PageSectionGalleryContent-dialogContainer-1HszE",innerContainer:"PageSectionGalleryContent-innerContainer-G0GCZ",panel:"PageSectionGalleryContent-panel-h9Zy2",hide:"PageSectionGalleryContent-hide-N5_bK"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var d=n(a("./common/temp/node_modules/lodash/get.js"));var u=n(a("./common/temp/node_modules/lodash/isNumber.js"));var o=n(a("./common/temp/node_modules/alt-utils/lib/connectToStores.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/PageSectionGalleryContent.js"));var l=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/PageSectionsStore.js"));var i=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/FooterSectionsStore.js"));var g=a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionSettings/utils/StoreUtils.js");var b=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/ContentItemStore.js"));var c=n(a("./src/main/webapp/universal/src/shared/stores/JobStore.js"));var p=n(a("./src/main/webapp/universal/src/shared/stores/UploadStore.js"));var I=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/GalleryStore.js"));var m=a("./src/main/webapp/universal/src/apps/App/shared/redux/CmsStoreProvider.js");var f=a("./src/main/webapp/universal/src/apps/App/shared/redux/selectors/index.js");function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),true).forEach(function(e){(0,r.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var y=function e(t){var i=c.default.getState();if(!t)return{};var a=Object.values(p.default.getState()).filter(function(e){return e&&e.data.collectionId===t}).map(function(e){var t=e.file;var a=e.status;var n;var r;var o;(0,d.default)(e,["data","job","id"])?o=e.data.job&&e.data.job:(0,d.default)(e,["data","data","job","id"])&&(o=e.data.data.job);if(o){n=o.id;var s=i[n];s?r=s.status:(0,u.default)(o.status)&&(r=o.status)}!t&&(0,d.default)(e,["data","data","fileData"])&&(t=e.data.data.fileData);!t&&(0,d.default)(e,["data","data","fileUrl"])&&(t={url:e.data.data.fileUrl});var l=e.data.index;return h({},e,{uploadStatus:a,jobId:n,jobStatus:r,file:t,displayIndex:l})});return a};var C=(0,o.default)({getStores:function e(){return[l.default,b.default,c.default,p.default,I.default,i.default]},getPropsFromStores:function e(t){var a,n,r;var o=t.sectionEditContexts;var s=(0,g.getSectionStore)(),l=s.isGalleryContentEditorOpen,i=s.sectionId;var d=I.default.getState(),u=d.items,c=d.finishedJobs;var p=o[i];var m="gallery"===(null===p||void 0===p?void 0:p.sectionDefinitionName)?null===p||void 0===p?void 0:null===(a=p.jsonData)||void 0===a?void 0:null===(n=a.galleryOptions)||void 0===n?void 0:n.transientGalleryId:null===p||void 0===p?void 0:null===(r=p.galleryOptions)||void 0===r?void 0:r.transientGalleryId;var f=Object.values(b.default.getState().toJS());f.sort(function(e,t){return e.displayIndex>t.displayIndex?1:-1});var v=f.filter(function(e){return e&&e.collectionId===m});var h=y(m);return{isGalleryContentEditorOpen:l,section:p,galleryId:m,items:v,itemsMap:m?u:[],uploads:h,finishedJobs:c}}},s.default);var S=(0,m.cmsStoreConnect)(function(e){return{sectionEditContexts:(0,f.getSectionEditContexts)(e)}})(C);t.default=S;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/react/index.js"));var o=n(a("./common/temp/node_modules/lodash/noop.js"));var s=r.default.createContext({uploadFiles:o.default,validateFiles:o.default});var l=s;t.default=l;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContextProvider.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var r=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var o=r(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=r(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=r(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=r(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var d=r(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=r(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var c=r(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var p=r(a("./common/temp/node_modules/react/index.js"));var m=r(a("./common/temp/node_modules/prop-types/index.js"));var v=r(a("./common/temp/node_modules/lodash/uniqueId.js"));var h=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var g=r(a("./src/main/webapp/universal/src/shared/utils/buildUploadPostData.js"));var b=a("./src/main/webapp/universal/src/shared/utils/uploadToken.js");var I=r(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var y=r(a("./src/main/webapp/universal/src/shared/constants/UploadModes.js"));var C=r(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var S=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var E=a("./src/main/webapp/universal/src/shared/utils/UploadAPI.js");var j=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentCollectionActions.js"));var P=r(a("./src/main/webapp/frontend/packages/enums/CollectionTypes.js"));var w=r(a("./src/main/webapp/frontend/packages/enums/CollectionOrdering.js"));var D=r(a("./src/main/webapp/frontend/packages/enums/WorkflowStates.js"));var k=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/getAssetReferenceUrl.ts"));var _=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/MediaUploadService.js"));var A=r(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var R=r(a("./src/main/webapp/universal/src/apps/App/shared/utils/ContentItemAPI.js"));var f=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));var x=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/videoDataSchema.js"));var O=r(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js"));var M=r(a("./src/main/webapp/universal/src/apps/App/shared/utils/createContentItemFromAsset.js"));var T=r(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/actions/ImagePickerViewActions.js"));function U(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function F(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?U(Object(a),true).forEach(function(e){(0,c.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function L(r){var o=G();return function e(){var t=(0,u.default)(r),a;if(o){var n=(0,u.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,d.default)(this,a)}}function G(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var N=function(e){(0,i.default)(r,e);var n=L(r);function r(){var f;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];f=n.call.apply(n,[this].concat(t));(0,c.default)((0,l.default)(f),"fileInputRef",p.default.createRef());(0,c.default)((0,l.default)(f),"getUploadData",function(e,t,a){return(0,g.default)(e,a?S.VIDEO:S.IMAGE,y.default.ITEM,t)});(0,c.default)((0,l.default)(f),"createNewCollection",function(){var e=(0,h.t)("Transient Gallery {galleryId}",{galleryId:(0,v.default)()});return j.default.create({type:P.default.GALLERY_BLOCK,ordering:w.default.USER,typeName:"transient-gallery",navigationTitle:e})});(0,c.default)((0,l.default)(f),"uploadFromFileUrl",function(t,a,e){var n=f.props,r=n.items,o=n.collectionId,s=void 0===o?e:o,l=n.onCollectionIdCreated,i=n.onStartUploadingFile;if(!s){f.createNewCollection().then(function(e){l(e);f.uploadFromFileUrl(t,a,e)});return}var d=f.getLastItemDisplayIndex(r);var u=(0,b.getUploadToken)();var c=f.getUploadData(a,{index:d+1,collectionId:s},false);i(u,{url:t});I.default.uploadFromFileUrl(u,E.URLS.GALLERY_IMAGE(s),c)});(0,c.default)((0,l.default)(f),"uploadFiles",function(t,e){var a=f.props,n=a.items,r=a.collectionId,o=void 0===r?e:r,s=a.onCollectionIdCreated,l=a.onStartUploadingFile;if(!o){f.createNewCollection().then(function(e){s(e);f.uploadFiles(t,e)});return}var i=(0,b.getMultipleUploadTokens)(t.length);var d=t.map(function(e,t){l(i[t],e);var a=f.getLastItemDisplayIndex(n);return f.getUploadData(e,{index:a+t+1,collectionId:o},false)});if((0,_.isMediaUploadServiceEnabled)()){var u=(0,k.default)(k.AssetReferenceType.GALLERY_IMAGE,{collectionId:o});_.default.uploadFiles(i,d,u)}else{var c=E.URLS.GALLERY_IMAGE(o);var p=true;I.default.uploadFiles(i,c,d,p)}});(0,c.default)((0,l.default)(f),"uploadVideo",function(n,r,e){var t=f.props,a=t.items,o=t.collectionId,s=void 0===o?e:o,l=t.onCollectionIdCreated,i=t.onStartUploadingFile;if(!s){f.createNewCollection().then(function(e){l(e);f.uploadVideo(n,r,e)});return}var d=f.getLastItemDisplayIndex(a);var u=(0,b.getUploadToken)();var c=f.getUploadData(n,{index:d+1,collectionId:s},true);i(u,{url:n.thumbnailUrl});var p=(new Date).getTime();var m=F({},x.default,{addedOn:p,publishOn:p,collectionId:s,title:n.title,sourceUrl:n.url,displayIndex:d+1,structuredContent:F({},x.default.structuredContent,{oembed:n})},r===O.default.URL?{oembed:n}:{});R.default.createForCollection(m).then(function(e){var t=e.data;if(r===O.default.URL){var a=F({},c,{fileUrl:n.thumbnailUrl,collectionId:t.collectionId,replaceItemId:t.id});I.default.uploadFromFileUrl(u,E.URLS.VIDEO,a)}})});(0,c.default)((0,l.default)(f),"handleChooseAssetIds",function(t,e){var a=f.props,n=a.onCollectionIdCreated,r=a.handleOnChange;var o=e||f.props.collectionId;T.default.closeImagePicker();if(!o){f.createNewCollection().then(function(e){n(e);f.handleChooseAssetIds(t,e)});return}var s=t.assetIds[0];(0,M.default)(k.AssetReferenceType.GALLERY_IMAGE,s,o).then(function(e){A.default.insert(e);r()})});(0,c.default)((0,l.default)(f),"reuseImage",function(t,e){var a=f.props,n=a.collectionId,r=void 0===n?e:n,o=a.onCollectionIdCreated,s=a.handleOnChange;if(!r){f.createNewCollection().then(function(e){o(e);f.reuseImage(t,e)});return}R.default.copy(t,D.default.PUBLISHED,r).then(function(e){var t=e.data;A.default.insert(t);s()})});(0,c.default)((0,l.default)(f),"replaceImage",function(e,t){var a=f.props,n=a.dirtyMap,r=a.clearDirtyMap;var o=(0,b.getUploadToken)();var s=f.getUploadData(e,{index:t.displayIndex,collectionId:f.props.collectionId,replaceItemId:t.id});n.has(t.id)?A.default.updateForCollection(t).then(function(){r();f.doReplaceImage(o,e,s)}):f.doReplaceImage(o,e,s)});(0,c.default)((0,l.default)(f),"doReplaceImage",function(e,t,a){var n=f.props,r=n.onStartUploadingFile,o=n.collectionId;r(e,t);I.default.uploadFile(e,E.URLS.GALLERY_IMAGE(o),a)});(0,c.default)((0,l.default)(f),"getFileTooLargeError",function(e){return(0,h.t)("The file {name} is too large. The maximum allowed file size is {size}MB.",{name:e.name,size:f.props.maxFileSizeMb})});(0,c.default)((0,l.default)(f),"getInvalidTypeError",function(e){return(0,h.t)("The file {name} does not appear to be a supported image file.",{name:e.name})});(0,c.default)((0,l.default)(f),"getLastItemDisplayIndex",function(e){var t;if(e.length>0){t=e.length-1;"number"===typeof e[e.length-1].displayIndex&&(t=Math.max(e[e.length-1].displayIndex,e.length-1))}else t=-1;var a=f.props.uploads;a.length>0&&"number"===typeof a[a.length-1].displayIndex&&(t=Math.max(a[a.length-1].displayIndex,t));return t});(0,c.default)((0,l.default)(f),"validateFiles",function(e){var t=f.props,a=t.maxFileSizeMb,n=t.validMimeTypes;var r={tooLarge:[],invalidType:[]};var o=[];var s=e.filter(function(e){if(e.size>1024*a*1024){r.tooLarge.push(e);return false}if(!n.includes(e.type)){r.invalidType.push(e);return false}return true});(r.tooLarge.length||r.invalidType)&&(o=f.generateErrorMessages(r));return{errors:r,invalidFilesErrors:o,validFiles:s}});(0,c.default)((0,l.default)(f),"cancelUpload",function(e){I.default.cancelUpload(e)});(0,c.default)((0,l.default)(f),"cancelJob",function(e){(0,_.isMediaUploadServiceEnabled)()?C.default.cancelMediaUploadServiceJob(e):C.default.cancel(e)});(0,c.default)((0,l.default)(f),"contextValue",{validateFiles:f.validateFiles,uploadFiles:f.uploadFiles,uploadFromFileUrl:f.uploadFromFileUrl,uploadVideo:f.uploadVideo,onChooseAssetIds:f.handleChooseAssetIds,reuseImage:f.reuseImage,replaceImage:f.replaceImage,cancelUpload:f.cancelUpload,cancelJob:f.cancelJob,dropzonePortalContainerRef:f.props.dropzonePortalContainerRef});return f}(0,s.default)(r,[{key:"generateErrorMessages",value:function e(t){var a=[].concat((t.tooLarge||[]).map(this.getFileTooLargeError),(t.invalidType||[]).map(this.getInvalidTypeError));return a.length?a.join("\n"):null}},{key:"render",value:function e(){return p.default.createElement(f.default.Provider,{value:this.contextValue},this.props.children)}}]);return r}(p.default.Component);t.default=N;(0,c.default)(N,"propTypes",{items:m.default.array.isRequired,uploads:m.default.array.isRequired,uploadingFilesMap:m.default.object.isRequired,maxFileSizeMb:m.default.number.isRequired,onCollectionIdCreated:m.default.func.isRequired,onStartUploadingFile:m.default.func.isRequired,handleOnChange:m.default.func.isRequired,validMimeTypes:m.default.arrayOf(m.default.string).isRequired,collectionId:m.default.string});e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/deleteMessages.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var r={singleTitle:{video:(0,n.t)("Remove Video"),image:(0,n.t)("Remove Image")},singleDetail:{video:(0,n.t)("Are you sure you wish to remove this video? This action cannot be undone."),image:(0,n.t)("Are you sure you wish to remove this image? This action cannot be undone.")},multipleTitle:{video:(0,n.t)("Remove Videos"),image:(0,n.t)("Remove Images"),mixed:(0,n.t)("Remove Images/Videos")},multipleDetail:{video:(0,n.t)("Are you sure you wish to remove selected videos? This action cannot be undone."),image:(0,n.t)("Are you sure you wish to remove selected images? This action cannot be undone."),mixed:(0,n.t)("Are you sure you wish to remove selected images/videos? This action cannot be undone.")}};var o=r;t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/embedTypes.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n={MANUAL:"manual",URL:"url"};var r=n;t.default=r;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/errors.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FAILED_TO_LOAD_IMAGES=void 0;var n="FAILED_TO_LOAD_IMAGES";t.FAILED_TO_LOAD_IMAGES=n},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/isMobile.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=a("./common/temp/node_modules/@sqs/rosetta-tokens/build/lib/index.js");var r=a("./common/temp/node_modules/@sqs/rosetta-utilities/build/lib/index.js");var o=function e(){var t=(0,r.getBreakpoint)(n.breakpoints),a=t.platform;return"mobile"===a};t.default=o;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/makeCancellable.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.withCanceledState=t.makeCancelableCallback=t.makeCancelablePromise=void 0;var n=function e(n){var r=false;var t=new Promise(function(t,a){n.then(function(e){return r?a({isCanceled:true}):t(e)},function(e){return a(r?{isCanceled:true}:e)})});return{promise:t,cancel:function e(){r=true}}};t.makeCancelablePromise=n;var r=function e(t){var a=false;var n=function e(){if(!a)return t.apply(void 0,arguments)};n.cancel=function(){a=true};return n};t.makeCancelableCallback=r;var o=function e(t){var o=false;var a=function e(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o)return;var t=new Promise(function(t,a){n.then(function(e){if(o){r&&a({isCanceled:true});return}t(e)},function(e){if(o){r&&a({isCanceled:true});return}a(e)})});return t};var n=function e(t){var a=function e(){if(!o)return t.apply(void 0,arguments)};a.cancel=function(){o=true};return a};t.cancel=function(){o=true};return n(t({makeCancelablePromise:a,makeCancelableCallback:n}))};t.withCanceledState=o},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/videoDataSchema.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./src/main/webapp/frontend/packages/enums/RecordType.js"));var o=n(a("./src/main/webapp/frontend/packages/enums/WorkflowStates.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/constants/LicensedAssetDestination.js"));var l={proxyForId:null,recordType:r.default.VIDEO,childType:null,unsaved:null,updatedOn:null,urlId:null,title:null,body:null,excerpt:{html:"",raw:false},displayIndex:0,starred:false,passthrough:false,tags:[],categories:[],workflowState:o.default.PUBLISHED,systemDataId:null,systemDataVariants:null,systemDataOrigin:null,contentType:null,fileName:null,dataSize:null,sourceUrl:null,mediaProcessingState:null,mediaFocalPoint:{x:.5,y:.5},clickthroughUrl:null,location:null,customContent:null,likeCount:0,dislikeCount:0,commentCount:0,publicCommentCount:0,commentState:2,commentDisableOn:null,pushedServices:[],shareStates:[],structuredContent:{_type:"Embed",oembed:null,overlay:true},licensedAssetPreview:null,licensedAssetId:null,isPusher:true,isWordpressXmlFile:false,imageDestination:s.default.CONTENT_ITEM_MAIN_IMAGE};var i=l;t.default=i;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withImageEditor/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=I;var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var f=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var o=n(a("./common/temp/node_modules/lodash/noop.js"));var v=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImageEditor/index.js"));var h=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));function g(r){var o=b();return function e(){var t=(0,p.default)(r),a;if(o){var n=(0,p.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,c.default)(this,a)}}function b(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function I(a){var n=function(e){(0,u.default)(o,e);var r=g(o);function o(){var a;(0,l.default)(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a=r.call.apply(r,[this].concat(t));(0,m.default)((0,d.default)(a),"state",{isEditorOpen:false});(0,m.default)((0,d.default)(a),"openEditor",function(e){if(!e){console.error("Trying to edit an invalid content item");return}a.props.setIsBackspaceToDeleteEnabled(false);a.setState({isEditorOpen:true,contentItem:e})});(0,m.default)((0,d.default)(a),"handleCancelImageEditor",function(){a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isEditorOpen:false,contentItem:null})});(0,m.default)((0,d.default)(a),"handleSaveImageEditor",function(e){var t=a.state.contentItem;if(!t){console.error("Trying to save an invalid content item");return}a.props.replaceImage(e,t);a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isEditorOpen:false,contentItem:null})});return a}(0,i.default)(o,[{key:"render",value:function e(){var t=this.state.contentItem;return f.default.createElement(f.default.Fragment,null,f.default.createElement(a,(0,s.default)({},this.props,{openEditor:this.openEditor})),f.default.createElement(v.default,{imageSrc:t&&t.assetUrl,isOpen:this.state.isEditorOpen,onCancel:this.handleCancelImageEditor,onSave:this.handleSaveImageEditor}))}}]);return o}(f.default.Component);(0,m.default)(n,"propTypes",{replaceImage:r.default.func.isRequired,setIsBackspaceToDeleteEnabled:r.default.func});(0,m.default)(n,"defaultProps",{setIsBackspaceToDeleteEnabled:o.default});return function(a){return f.default.createElement(h.default.Consumer,null,function(e){var t=e.replaceImage;return f.default.createElement(n,(0,s.default)({},a,{replaceImage:t}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withLicensedImagePurchaseModal/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=y;var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/objectWithoutProperties.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var c=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var f=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var v=n(a("./common/temp/node_modules/react/index.js"));var r=n(a("./common/temp/node_modules/prop-types/index.js"));var o=n(a("./common/temp/node_modules/lodash/noop.js"));var h=n(a("./src/main/webapp/universal/src/apps/App/shared/components/LicenseImage/index.js"));var g=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));function b(r){var o=I();return function e(){var t=(0,m.default)(r),a;if(o){var n=(0,m.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,s.default)(this,a)}}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function y(s){var n=function(e){(0,p.default)(o,e);var r=b(o);function o(){var a;(0,d.default)(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a=r.call.apply(r,[this].concat(t));(0,f.default)((0,c.default)(a),"state",{isPurchaseLicenseOpen:false});(0,f.default)((0,c.default)(a),"openPurchaseLicenseModal",function(){a.props.setIsBackspaceToDeleteEnabled(false);a.setState({isPurchaseLicenseOpen:true})});(0,f.default)((0,c.default)(a),"uploadPurchasedLicensedImage",function(e,t){a.props.uploadFromFileUrl(t.url,t);a.setState({isPurchaseLicenseOpen:false})});return a}(0,u.default)(o,[{key:"renderPurchaseDialogIfNeeded",value:function e(){var a=this;var t=this.props.selectedIds[0];if(!t)return null;var n=this.props.items.find(function(e){return e.id===t});if(!n||!n.licensedAssetPreview)return null;return v.default.createElement(h.default,{key:"licensed-image-purchase-modal",assetPreview:n.licensedAssetPreview,previewUrl:n.assetUrl,isOpen:this.state.isPurchaseLicenseOpen,onRequestClose:function e(){a.props.setIsBackspaceToDeleteEnabled(true);a.setState({isPurchaseLicenseOpen:false})},onPurchaseSuccess:function e(t){return a.uploadPurchasedLicensedImage(n.id,t)}})}},{key:"render",value:function e(){var t=this.props,a=t.uploadFromFileUrl,n=(0,i.default)(t,["uploadFromFileUrl"]);return v.default.createElement(v.default.Fragment,null,v.default.createElement(s,(0,l.default)({},n,{openPurchaseLicenseModal:this.openPurchaseLicenseModal})),this.renderPurchaseDialogIfNeeded())}}]);return o}(v.default.Component);(0,f.default)(n,"propTypes",{setIsBackspaceToDeleteEnabled:r.default.func});(0,f.default)(n,"defaultProps",{setIsBackspaceToDeleteEnabled:o.default});return function(a){return v.default.createElement(g.default.Consumer,null,function(e){var t=e.uploadFromFileUrl;return v.default.createElement(n,(0,l.default)({},a,{uploadFromFileUrl:t}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/index.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=w;var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var f=n(a("./common/temp/node_modules/react/index.js"));var v=n(a("./common/temp/node_modules/react-dom/index.js"));var o=n(a("./common/temp/node_modules/prop-types/index.js"));var h=n(a("./common/temp/node_modules/classnames/index.js"));var g=a("./src/main/webapp/universal/src/shared/i18n/index.ts");var b=n(a("./common/temp/node_modules/@sqs/core-components/web/modals/AlertModal.js"));var I=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/UploaderContext/UploaderContext.js"));var y=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/actions/ImagePickerViewActions.js"));var C=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/actions/GettyImageActions.js"));var S=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/constants/LicensedAssetDestination.js"));var E=n(a("./src/main/webapp/universal/src/apps/App/shared/components/ImagePicker/index.js"));var j=n(a("./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/styles.less"));function P(r){var o=c();return function e(){var t=(0,u.default)(r),a;if(o){var n=(0,u.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,d.default)(this,a)}}function c(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function w(t){var c=function(e){(0,i.default)(o,e);var n=P(o);function o(){var r;(0,s.default)(this,o);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];r=n.call.apply(n,[this].concat(t));(0,m.default)((0,l.default)(r),"state",{dragOver:false,invalidFilesErrors:null,alertModalOpen:false});(0,m.default)((0,l.default)(r),"fileInputRef",f.default.createRef());(0,m.default)((0,l.default)(r),"onDiscardInvalidFilesAlert",function(){r.setState({alertModalOpen:false})});(0,m.default)((0,l.default)(r),"onDragEnter",function(e){e.preventDefault();r.setState({dragOver:true})});(0,m.default)((0,l.default)(r),"onDragOver",function(e){e.preventDefault();try{e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed=e.dataTransfer.dropEffect}catch(e){}});(0,m.default)((0,l.default)(r),"onDragLeave",function(e){r.setState({dragOver:false});r.props.disableDropZone()});(0,m.default)((0,l.default)(r),"validateAndUpload",function(e){var t=r.props.validateFiles(e),a=t.validFiles,n=t.invalidFilesErrors;n&&n.length&&r.setState({invalidFilesErrors:n,alertModalOpen:true});a.length&&r.props.uploadFiles(a)});(0,m.default)((0,l.default)(r),"onDrop",function(e){e.preventDefault();e.stopPropagation();r.setState({dragOver:false});r.props.disableDropZone();var t=Array.from(e.dataTransfer.files);r.validateAndUpload(t)});(0,m.default)((0,l.default)(r),"onFileUploaderChanges",function(e){var t=e instanceof Array?e:Array.from(e.target.files);r.validateAndUpload(t)});(0,m.default)((0,l.default)(r),"handleChooseImageUrl",function(e){var t=e.data;y.default.finishLoadingImage();y.default.closeImagePicker();r.props.uploadFromFileUrl(t.url,t)});(0,m.default)((0,l.default)(r),"onLicensedImagePicked",function(e){y.default.finishLoadingImage();y.default.closeImagePicker();if(e.cloneItemId){r.props.reuseImage(e.cloneItemId);return}r.props.uploadFromFileUrl(e.url,e)});(0,m.default)((0,l.default)(r),"openFileInput",function(){r.fileInputRef.current&&r.fileInputRef.current.click()});(0,m.default)((0,l.default)(r),"openLicensedImagePicker",function(){C.default.search();y.default.openImagePicker()});(0,m.default)((0,l.default)(r),"renderOverlayIfPossible",function(e){var t;var a=r.props.dropzonePortalContainerRef;if(!a.current)return null;return v.default.createPortal(f.default.createElement("div",{className:(0,h.default)(j.default.dropzone,(t={},(0,m.default)(t,j.default.onDragOver,r.state.dragOver),(0,m.default)(t,j.default.disablePointerEvents,!r.props.dropZoneEnabled),(0,m.default)(t,j.default.hasNoItems,!e),t)),onDragEnter:r.onDragEnter,onDragOver:r.onDragOver,onDragLeave:r.onDragLeave,onDrop:r.onDrop},r.state.dragOver?f.default.createElement("p",null,(0,g.t)("Drop Images to Upload")):e?null:f.default.createElement("p",null,(0,g.t)("Drag your image here or click + to upload")),f.default.createElement("input",{ref:r.fileInputRef,className:j.default.hiddenInput,accept:"image/png,image/gif,image/jpeg",type:"file",multiple:true,onChange:r.onFileUploaderChanges})),a.current)});return r}(0,r.default)(o,[{key:"render",value:function e(){return f.default.createElement(f.default.Fragment,null,f.default.createElement(b.default,{isOpen:this.state.alertModalOpen,title:(0,g.t)("Invalid files"),message:this.state.invalidFilesErrors,onDismiss:this.onDiscardInvalidFilesAlert,onRequestClose:this.onDiscardInvalidFilesAlert}),f.default.createElement(E.default,{baseZIndex:300001,onChooseAssetIds:this.props.onChooseAssetIds,onChooseImageUrl:this.handleChooseImageUrl,onUnlicensedPreview:this.onLicensedImagePicked,onLicensedPreview:this.onLicensedImagePicked,imageDestination:S.default.GALLERY_COLLECTION}),f.default.createElement(t,(0,p.default)({},this.props,{uploader:{openLicensedImagePicker:this.openLicensedImagePicker,openFileInput:this.openFileInput,onFileUploaderChanges:this.onFileUploaderChanges,renderOverlayIfPossible:this.renderOverlayIfPossible}})))}}]);return o}(f.default.Component);(0,m.default)(c,"propTypes",{uploadFiles:o.default.func.isRequired,validateFiles:o.default.func.isRequired});return function(u){return f.default.createElement(I.default.Consumer,null,function(e){var t=e.uploadFiles,a=e.validateFiles,n=e.uploadFromFileUrl,r=e.onChooseAssetIds,o=e.reuseImage,s=e.uploadVideo,l=e.cancelUpload,i=e.cancelJob,d=e.dropzonePortalContainerRef;return f.default.createElement(c,(0,p.default)({},u,{uploadFiles:t,validateFiles:a,uploadFromFileUrl:n,onChooseAssetIds:r,reuseImage:o,uploadVideo:s,cancelUpload:l,cancelJob:i,dropzonePortalContainerRef:d}))})}}e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionGalleryContent/utils/withUploader/styles.less":function(e,t,a){e.exports={dropzone:"styles-dropzone-3FnFe",hasNoItems:"styles-hasNoItems-1B9N9",disablePointerEvents:"styles-disablePointerEvents-1bN8B",onDragOver:"styles-onDragOver-BIi3x",hiddenInput:"styles-hiddenInput-5HZ0r"}},"./src/main/webapp/universal/src/apps/App/shared/components/PageSectionSettings/utils/StoreUtils.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.getSectionActions=t.getSectionStore=void 0;var r=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/PageSectionsStore.js"));var o=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/FooterSectionsStore.js"));var s=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/PageSectionsActions.js"));var l=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/FooterSectionsActions.js"));var i=function e(){var t=r.default.getState();var a=o.default.getState();var n=a.isEditing?a:t;return n};t.getSectionStore=i;var d=function e(){var t=o.default.getState();var a=t.isEditing?l.default:s.default;return a};t.getSectionActions=d},"./src/main/webapp/universal/src/apps/App/shared/stores/GalleryStore.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var i=n(a("./src/main/webapp/universal/src/shared/dispatchers/alt/index.ts"));var d=n(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var u=n(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var c=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var p=n(a("./src/main/webapp/universal/src/shared/stores/JobStore.js"));var m=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/GalleryActions.js"));function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),true).forEach(function(e){(0,r.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var h=function e(t,a){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];t.splice.apply(t,[a,0].concat(r));return t};var g=function e(t,a){t.splice(t.indexOf(a),1);return t};var b=function e(t,a,n){t.splice(t.indexOf(a),1,n);return t};var I=function(){function e(){(0,o.default)(this,e);this.state={loading:false,error:null,collectionId:null,items:[],finishedJobs:[]};this.bindActions(m.default);this.bindListeners({onUploadFile:[d.default.UPLOAD_FILE_TO_MEDIA_UPLOAD_SERVICE,d.default.UPLOAD_FILE,d.default.UPLOAD_FROM_FILE_URL],onMediaUploadServiceUploadSuccess:d.default.MEDIA_UPLOAD_SERVICE_UPLOAD_SUCCESS,onMediaUploadServiceJobSuccess:u.default.MEDIA_UPLOAD_SERVICE_JOB_SUCCESS,onCancelMediaUploadServiceJob:u.default.CANCEL_MEDIA_UPLOAD_SERVICE_JOB,onCreateAssetReferenceSuccess:c.default.CREATE_ASSET_REFERENCE_SUCCESS,onCreateAssetReferenceFailure:c.default.CREATE_ASSET_REFERENCE_FAILURE,onCancelCreateAssetReference:c.default.CANCEL_CREATE_ASSET_REFERENCE,onUploadProgress:d.default.UPLOAD_PROGRESS,onUploadSuccess:d.default.UPLOAD_SUCCESS,onJobComplete:u.default.COMPLETE,onCancelUpload:d.default.CANCEL_UPLOAD,onCancelJob:[u.default.CANCEL,u.default.DELETE],onCreateNewItem:c.default.createForCollection,onInsert:c.default.insert,onItemRemove:c.default.delete,onItemsRemove:c.default.deleteMany,onItemReorder:c.default.reorderItems})}(0,s.default)(e,[{key:"onLoadStart",value:function e(){this.setState({loading:true,error:null})}},{key:"onLoadSuccess",value:function e(t){var a=t.collectionId,n=void 0===a?null:a,r=t.contentItems,o=void 0===r?[]:r,s=t.uploads,l=void 0===s?[]:s;var i=o.sort(function(e,t){return e.displayIndex<t.displayIndex?-1:1}).map(function(e){return{key:"item-".concat(e.id),contentItemId:e.id}});l.forEach(function(e){var t=e.token,a=e.data;h(i,a.index,{key:"new-".concat(t.getId()),uploadToken:t})});this.setState({loading:false,error:null,collectionId:n,items:i})}},{key:"onLoadFailure",value:function e(t){var a=t.collectionId,n=void 0===a?null:a,r=t.error;this.setState({loading:false,error:r,collectionId:n})}},{key:"onUploadFile",value:function e(t){var a=t.token,n=t.data;var r=n.collectionId,o=n.replaceItemId,s=n.index;if(r===this.state.collectionId){var l=[].concat(this.state.items);if(o){var i=l.find(function(e){return e.contentItemId===o});i?b(l,i,{key:i.key,uploadToken:a}):h(l,s,{key:"new-".concat(a.getId()),uploadToken:a})}else h(l,s,{key:"new-".concat(a.getId()),uploadToken:a});this.setState({items:l})}}},{key:"onMediaUploadServiceUploadSuccess",value:function e(t){var a=t.token,n=t.data;var r=(0,l.default)(this.state.items);var o=r.find(function(e){return e.uploadToken===a});r=b(r,o,{key:o.key,jobId:n.jobId});this.setState({items:r})}},{key:"onMediaUploadServiceJobSuccess",value:function e(t){var a=(0,l.default)(this.state.items);var n=a.find(function(e){return e.jobId===t.id});var r=[].concat((0,l.default)(this.state.finishedJobs),[t.id]);a=b(a,n,{key:n.key,assetId:t.assetId});this.setState({items:a,finishedJobs:r})}},{key:"onCancelMediaUploadServiceJob",value:function e(a){var t=(0,l.default)(this.state.items);t=t.filter(function(e){var t=e.jobId;return t!==a});this.setState({items:t})}},{key:"onCreateAssetReferenceSuccess",value:function e(t){if(this.state.collectionId!==t.collectionId)return;var a=(0,l.default)(this.state.items);var n=a.find(function(e){return e.assetId===t.systemDataId});a=b(a,n,{key:n.key,contentItemId:t.id});this.setState({items:a})}},{key:"onCreateAssetReferenceFailure",value:function e(t){var a=t.details,n=t.createAssetReference;if(this.state.collectionId!==a.collectionId)return;var r=(0,l.default)(this.state.items);var o=r.find(function(e){return e.assetId===a.assetId});r=b(r,o,v({},o,{isCreateAssetReferenceFailure:true,createAssetReference:n}));this.setState({items:r})}},{key:"onCancelCreateAssetReference",value:function e(t){var a=(0,l.default)(this.state.items);var n=t.map(function(e){return e.assetId});a=a.filter(function(e){var t=e.assetId;return!n.includes(t)});this.setState({items:a})}},{key:"onUploadProgress",value:function e(t){var a=t.token,n=t.percent;var r=(0,l.default)(this.state.items);var o=r.find(function(e){return e.uploadToken===a});r=b(r,o,v({},o,{uploadPercent:n}));this.setState({items:r})}},{key:"onUploadSuccess",value:function e(t){var a=t.token,n=t.data;var r=this.state.items.find(function(e){return e.uploadToken===a});var o=n.job;if(r){var s=b([].concat(this.state.items),r,{key:r.key,contentItemId:n.contentItem.id});o&&(s=s.map(function(e){if(e.contentItemId===n.contentItem.id)return{key:r.key,contentItemId:n.contentItem.id,jobId:o.id};return e}));this.waitFor(p.default);this.setState({items:s})}}},{key:"onJobComplete",value:function e(t){var a=(0,l.default)(this.state.items);var n=(0,l.default)(this.state.finishedJobs);n=[].concat(n,t);a=a.map(function(e){if(e.jobId&&t.includes(e.jobId))return{key:e.key,contentItemId:e.contentItemId};return e});this.setState({items:a,finishedJobs:n})}},{key:"onCancelUpload",value:function e(t){var a=this.state.items.find(function(e){return e.uploadToken===t});if(a){var n=g([].concat(this.state.items),a);this.setState({items:n})}}},{key:"onCancelJob",value:function e(t){var a=p.default.getJobById(t).data.contentItemId;var n=this.state.items.find(function(e){return e.contentItemId===a});if(n){var r=g([].concat(this.state.items),n);this.setState({items:r})}}},{key:"onCreateNewItem",value:function e(t){if(!t.id)return;var a=h([].concat(this.state.items),t.displayIndex,{key:"item-".concat(t.id),contentItemId:t.id});this.setState({items:a})}},{key:"onInsert",value:function e(t){if(t.collectionId===this.state.collectionId){var a=this.state.items.find(function(e){return e.contentItemId===t.id});if(a)return;var n=h([].concat(this.state.items),t.displayIndex,{key:"item-".concat(t.id),contentItemId:t.id});this.setState({items:n})}}},{key:"onItemRemove",value:function e(t){var a=this.state.items.find(function(e){return e.contentItemId===t});if(a){var n=g([].concat(this.state.items),a);this.setState({items:n})}}},{key:"onItemsRemove",value:function e(t){var a=this.state.items.filter(function(e){return-1===t.indexOf(e.contentItemId)});a.length!==this.state.items.length&&this.setState({items:a})}},{key:"onItemReorder",value:function e(t){var a=t.collectionId,n=t.reorderedItems,r=t.afterItemId;if(a===this.state.collectionId){var o=[].concat(this.state.items);var s=r?o.findIndex(function(e){var t=e.contentItemId;return t===r}):-1;o.splice.apply(o,[s+1,n.length].concat((0,l.default)(n.map(function(e){var t=e.id;return o.find(function(e){return e.contentItemId===t})}))));this.setState({items:o})}}}]);return e}();var y=i.default.createStore(I,"GalleryStore");t.default=y;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/utils/MediaUploadService.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.isMediaUploadServiceEnabled=v;t.default=void 0;var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var l=n(a("./src/main/webapp/frontend/packages/enums/Flag.js"));var i=n(a("./src/main/webapp/universal/src/shared/utils/AltActionListener.js"));var d=a("./src/main/webapp/universal/src/shared/utils/coreCmsFlags.ts");var u=n(a("./src/main/webapp/universal/src/shared/actions/UploadActions.js"));var c=n(a("./src/main/webapp/universal/src/shared/actions/JobActions.js"));var p=n(a("./src/main/webapp/universal/src/apps/App/shared/actions/ContentItemActions.js"));var m=n(a("./src/main/webapp/universal/src/apps/App/shared/stores/WebsiteStore/index.js"));var f=a("./src/main/webapp/frontend/packages/universal-flags/lib/index.js");function v(){return(0,d.isCoreCmsVariant)(d.ASSET_UPLOAD_TO_MEDIA_UPLOAD_SERVICE)||f.legacyV6Flags.isFeatureEnabled(l.default.ASSET_UPLOAD_TO_MEDIA_UPLOAD_SERVICE)}var h=function(){function e(){var t=this;(0,r.default)(this,e);(0,s.default)(this,"uploads",[]);i.default.addActionListener(c.default.MEDIA_UPLOAD_SERVICE_JOB_SUCCESS,function(e){return t.createAssetReference(e)})}(0,o.default)(e,[{key:"uploadFile",value:function e(t,a,n){var r=m.default.getState().id;this.uploads.push({token:t,data:a,assetReferenceUrl:n});return u.default.uploadFileToMediaUploadService(t,a,r)}},{key:"uploadFiles",value:function e(a,t,n){var r=m.default.getState().id;this.uploads=this.uploads.concat(t.map(function(e,t){return{token:a[t],data:e,assetReferenceUrl:n}}));return u.default.uploadFilesToMediaUploadService(a,t,r)}},{key:"createAssetReference",value:function e(t){var a=t.uploadToken,n=t.libraryId,r=t.assetId;var o=this.uploads.find(function(e){return e.token===a}),s=o.data,l=o.assetReferenceUrl;var i=s.collectionId,d=s.index,u=s.recordType;var c={libraryId:n,assetId:r,collectionId:i,index:d,recordType:u};this.uploads=this.uploads.filter(function(e){return e.token!==a});return p.default.createAssetReference(l,c,a)}}]);return e}();var g=new h;t.default=g},"./src/main/webapp/universal/src/shared/components/DragSelection.jsx":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");var p=n(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/objectWithoutProperties.js"));var f=n(a("./common/temp/node_modules/@babel/runtime/helpers/slicedToArray.js"));var o=n(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var s=n(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var l=n(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var i=n(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var d=n(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var u=n(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var v=n(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));function c(r){var o=h();return function e(){var t=(0,u.default)(r),a;if(o){var n=(0,u.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,d.default)(this,a)}}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}var g=a("./common/temp/node_modules/classnames/index.js");var r=a("./common/temp/node_modules/prop-types/index.js");var b=a("./common/temp/node_modules/react/index.js");var I=a("./common/temp/node_modules/@sqs/dnd/cjs/index.js"),y=I.DragTrigger;var C=a("./common/temp/node_modules/@sqs/utils/NodeCoordinatesTracker/index.js");var S=a("./common/temp/node_modules/@sqs/utils/number/clamp.js");var E=a("./common/temp/node_modules/@sqs/utils/events/parentScroll.js"),j=E.addScrollListenerToParents,P=E.removeScrollListenerFromParents;var w=a("./common/temp/node_modules/lodash/difference.js");var D=a("./common/temp/node_modules/lodash/throttle.js");var k=a("./src/main/webapp/universal/src/shared/components/DragSelection.less");var _=function e(t,a){return t.right>=a.left&&t.left<=a.right&&t.bottom>=a.top&&t.top<=a.bottom};var A=function(e){(0,i.default)(r,e);var n=c(r);function r(){var m;(0,o.default)(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];m=n.call.apply(n,[this].concat(t));(0,v.default)((0,l.default)(m),"state",{isDragging:false,itemsMap:null,selectionCoords:null,selectedItemIndexes:[],mouseXY:null,anchorXY:null});(0,v.default)((0,l.default)(m),"onDrag",D(function(e){var t=e.mouseX,a=e.mouseY,n=e.maxX,r=e.maxY,o=e.minX,s=e.minY;var l=m.state,i=l.itemsMap,d=l.anchorXY;if(!i)return;var u=[S(t,o,n),S(a,s,r)];var c=m.calculateSelectionCoords(u,d);var p=m.getContainedOrIntersectedItems(c);m.setState({mouseXY:u,selectionCoords:c,selectedItemIndexes:p})},30));return m}(0,s.default)(r,[{key:"componentDidMount",value:function e(){this.coordsTracker=new C(this.refs.container)}},{key:"shouldComponentUpdate",value:function e(t,a){return this.state.isDragging!==a.isDragging||this.state.selectionCoords!==a.selectionCoords}},{key:"componentDidUpdate",value:function e(t,a){var n=this.state.isDragging;n&&this.fireSelectionChange(a.selectedItemIndexes)}},{key:"componentWillUnmount",value:function e(){var t=this.state,a=t.itemsMap,n=t.isDragging;a&&a.forEach(function(e){var t=e.coordsTracker;return t.destroy()});this.coordsTracker.destroy();this.coordsTracker=null;n&&P(this.refs.container,this.udpateCoordsOnScroll)}},{key:"fireSelectionChange",value:function e(t){var a=this.state.selectedItemIndexes;var n=this.props.items;var r=w(a,t);var o=w(t,a);(r.length>0||o.length>0)&&this.props.onSelectionChange({added:r.map(function(e){return n[e]}),removed:o.map(function(e){return n[e]})})}},{key:"udpateCoordsOnScroll",value:function e(t,a){var n=this.state,r=n.mouseXY,o=n.anchorXY;var s=[o[0]+t,o[1]+a];this.setState({anchorXY:s,selectionCoords:this.calculateSelectionCoords(r,s)})}},{key:"onDragStart",value:function e(t){var a=t.startX,n=t.startY;var r=this.props,o=r.items,s=r.itemNodesGetter,e=r.onDragStart;this.coordsTracker.resetCoords();j(this.refs.container,this.udpateCoordsOnScroll);this.setState({isDragging:true,selectionCoords:null,itemsMap:s(o).map(function(e,t){return{index:t,coordsTracker:new C(e)}}),anchorXY:[a,n],mouseXY:[a,n]});e&&e.apply(void 0,arguments)}},{key:"calculateSelectionCoords",value:function e(t,a){var n=(0,f.default)(t,2),r=n[0],o=n[1];var s=(0,f.default)(a,2),l=s[0],i=s[1];var d;var u;var c;var p;if(l<=r){c=l;p=r}else{c=r;p=l}if(i<=o){d=i;u=o}else{d=o;u=i}return{top:d,left:c,bottom:u,right:p}}},{key:"getContainedOrIntersectedItems",value:function e(n){var t=this.state.itemsMap;if(t)return t.filter(function(e){var t=e.index,a=e.coordsTracker;return _(a.getCoords(),n)}).map(function(e){var t=e.index;return t});return[]}},{key:"onDragEnd",value:function e(){var t=this.state,a=t.itemsMap,n=t.selectedItemIndexes;var r=this.props,e=r.onDragEnd,o=r.items;a&&a.forEach(function(e){var t=e.coordsTracker;return t.destroy()});P(this.refs.container,this.udpateCoordsOnScroll);this.setState({isDragging:false,itemsMap:null,selectedItemIndexes:[],mouseXY:null,anchorXY:null});e&&e.apply(void 0,[{selectedItems:n.map(function(e){return o[e]})}].concat(Array.prototype.slice.call(arguments)))}},{key:"getAbsolutePosition",value:function e(t){var a=this.coordsTracker.getCoords();return{top:t.top-a.top,left:t.left-a.left,bottom:a.bottom-t.bottom,right:a.right-t.right}}},{key:"render",value:function e(){var t=this;var a=this.state,n=a.isDragging,r=a.selectionCoords;var o=this.props,s=o.className,l=o.children,i=(0,m.default)(o,["className","children"]);delete i.items;delete i.itemNodesGetter;delete i.onSelectionChange;var d=g(k.container,s,(0,v.default)({},k.dragging,n));var u=g(k.selection,n&&k.visible);var c=r?this.getAbsolutePosition(r):null;return b.createElement(y,(0,p.default)({key:"trigger",constraint:function e(){return t.refs.container}},i,{onDragStart:this.onDragStart.bind(this),onDrag:this.onDrag.bind(this),onDragEnd:this.onDragEnd.bind(this),autoScroll:{vertical:true}}),b.createElement("div",{ref:"container",key:"container",className:d},l,b.createElement("div",{key:"selection",className:u,style:c})))}}]);return r}(b.Component);(0,v.default)(A,"propTypes",{items:r.array.isRequired,itemNodesGetter:r.func.isRequired,onSelectionChange:r.func,onDragStart:r.func,onDragEnd:r.func});(0,v.default)(A,"defaultProps",{itemNodesGetter:function e(){return[]},items:[],onSelectionChange:function e(){}});(0,v.default)(A,"itemClassName",k.item);e.exports=A},"./src/main/webapp/universal/src/shared/components/DragSelection.less":function(e,t,a){e.exports={container:"DragSelection-container-CBfko",dragging:"DragSelection-dragging-2sGNZ",selection:"DragSelection-selection-2js8t",visible:"DragSelection-visible-g3fgA",item:"DragSelection-item-2EEHz"}}}]);
//# sourceMappingURL=https://sourcemaps.squarespace.net/universal/scripts-compressed/async-page-section-gallery-content-ad190f5f75a8d7e81fcb0-min.en-US.js.map